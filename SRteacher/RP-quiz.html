<!doctype html>
<html lang="zh-hant-TW">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="SmartReading 適性閱讀 教師端">
<meta name="author" content="SmartReading">
<meta name="generator" content="SmartReading">
<title>SmartReading 教師端</title>
<link rel="shortcut icon" type="image/x-icon" href="Content/images/favicon.ico">
<!-- google fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,100..900;1,100..900&family=Noto+Sans+TC:wght@100..900&display=swap" rel="stylesheet">

<!-- widgets CSS -->
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">
<link rel="stylesheet" type="text/css" href="Content/widgets/DataTables/datatables.min.css">

<!-- template CSS -->
<link rel="stylesheet" type="text/css" href="Content/css/bootstrap.css">
<link rel="stylesheet" type="text/css" href="Content/css/SRv3-manager.css">
</head>
<body>
<form>
  <header> </header>
  <div class="container-fluid">
    <div class="row">
      <nav id="sidebarMenu" class="col-xl-2 d-xl-block bg-white sidebar collapse"> </nav>
      <main class="col-xl-10"> 
        <!-- ------- ------- ------- ------- ------- ------- ------- -->
        <h2>教師命題管理</h2>
        <div class="row py-3 py-xl-5 px-1 px-xl-4"> 
          <!-- 按鈕 start -->
          <div class="col-xxl-5 mb-3" id="blockBtns">
            <button type="button" class="btn btn-primary my-1" id="setting"><i class="fa-solid fa-pen-to-square me-1"></i>編輯設定</button>
            <button type="button" class="btn btn-outline-primary bg-gradient my-1" id="insert"><i class="fa-solid fa-plus me-1"></i>發表新題本及題目</button>
          </div>
          <!-- 按鈕  end  --> 
          <!-- 搜尋 start -->
          <div class="col-xxl-7 mb-3" id="blockSearch">
            <div class="row g-2 align-items-center justify-content-end">
              <div class="col-auto d-none d-lg-inline ms-3">
                <label for="searchKeywords" class="col-form-label fs-7">搜尋</label>
              </div>
              <div class="col-auto">
                <div class="input-group">
                  <div class="input-group-clear">
                    <input type="text" class="form-control rounded-0" placeholder="請輸入關鍵字..." aria-label="請輸入關鍵字..." aria-describedby="btnSearch" id="searchKeywords">
                    <button class="btn btn-close" type="button"></button>
                  </div>
                  <button class="btn btn-gray-100 rounded-0 border-gray-400 text-primary lh-1" type="button" id="btnSearch"><i class="fa-solid fa-magnifying-glass fs-5 mx-n1"></i></button>
                </div>
              </div>
            </div>
          </div>
          <!-- 搜尋  end  --> 
          <!-- 表格 start -->
          <div class="col-xl-12 mb-5">
            <table class="table table-bordered table-quiz" id="quizTable">
              <thead>
                <tr>
                  <th scope="col" class="row-delete">刪除</th>
                  <th scope="col" class="row-index">序號</th>
                  <th scope="col" class="row-bookTitle">書名</th>
                  <th scope="col" class="row-ISBN">ISBN</th>
                  <th scope="col" class="row-author">作者</th>
                  <th scope="col" class="row-quizCount">題本數</th>
                  <th scope="col" class="row-quizDetail">題本詳情</th>
                  <th scope="col" class="row-quizInsert">新增本書題本</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="row-delete"><div class="SRform-check-red">
                      <input class="form-check-input" type="checkbox" name="delete">
                    </div></td>
                  <td class="row-index">1</td>
                  <td class="row-bookTitle">老樹之歌</td>
                  <td class="row-ISBN">9889573269670</td>
                  <td class="row-author">劉克襄 作； 阿桂 繪</td>
                  <td class="row-quizCount">2</td>
                  <td class="row-quizDetail"><button type="button" class="btn btn-link btn-toggle-child">顯示詳情</button></td>
                  <td class="row-quizInsert"><button type="button" class="btn btn-primary">新增</button></td>
                </tr>
              </tbody>
            </table>
          </div>
          <!-- 表格  end  --> 
          <!-- [編輯設定]-按鈕 start -->
          <div class="col-xl-12 text-center mb-5" id="blockSettingBtns" style="display: none;">
            <div>
              <button type="button" class="btn btn-outline-primary m-1" id="settingCancel">取消</button>
              <button type="button" class="btn btn-primary m-1" id="settingConfirm">確定設定</button>
            </div>
          </div>
          <!-- [編輯設定]-按鈕  end  --> 
        </div>
        
        <!-- ------- ------- ------- ------- ------- ------- ------- --> 
      </main>
    </div>
  </div>
  
  <!-- Modal#insertModal 發表新題本及題目 start -->
  <div class="modal fade" id="insertModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="insertModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered">
      <div class="modal-content rounded-0">
        <div class="modal-header">
          <button type="button" class="btn-close float-start" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body"> 
          <!-- ↓ 跟10重複的地方↓ -->
          <div class="row mb-3">
            <h3 class="text-center h6">發表新題本及題目</h3>
          </div>
          <!-- 搜尋 start -->
          <div class="row mb-3 justify-content-center">
            <label for="inputSearchBook" class="col-auto col-form-label">搜索書籍</label>
            <div class="col-lg-8">
              <div class="input-group mb-3 position-relative"> 
                <!-- -->
                <button class="btn btn-link border-primary bg-gray-200 rounded-0 dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">系統推薦</button>
                <ul class="dropdown-menu rounded-0 p-0 fs-7 border-primary w-min-auto">
                  <li><a class="dropdown-item" href="#">系統推薦</a></li>
                  <li><a class="dropdown-item" href="#">未分級書單</a></li>
                </ul>
                <!-- -->
                <input type="text" class="form-control border-primary border-end-0 rounded-0" aria-label="Text input with dropdown button" placeholder="輸入書名...">
                <!-- -->
                <button class="btn btn-link border-primary border-start-0 rounded-0 dropdown-toggle" type="button" data-bs-toggle="dropdown" data-bs-display="static" aria-expanded="false" id="dropdownMore">更多選項</button>
                <div class="dropdown-menu border-primary rounded-0 p-3 fs-7 w-100">
                  <div class="row mb-3">
                    <label for="inputPassword" class="col-sm-2 col-form-label">作者</label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control rounded-0" id="searchAuthor">
                    </div>
                  </div>
                  <div class="row mb-3">
                    <label for="inputPassword" class="col-sm-2 col-form-label">出版社</label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control rounded-0" id="searchPublisher">
                    </div>
                  </div>
                  <div class="row mb-3">
                    <label for="inputPassword" class="col-sm-2 col-form-label">出版年</label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control rounded-0" id="searchPublicationYear" placeholder="西元年...">
                    </div>
                  </div>
                  <div class="row mb-3">
                    <label for="inputPassword" class="col-sm-2 col-form-label">ISBN</label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control rounded-0 " id="searchISBN">
                    </div>
                  </div>
                  <div class="text-end">
                    <button type="button" class="btn btn-light">清除</button>
                    <button type="button" class="btn btn-primary">確定</button>
                  </div>
                </div>
                <!-- -->
                <button type="button" class="btn btn-primary rounded-0">搜索</button>
                <!-- --> 
              </div>
            </div>
          </div>
          <div class="row my-5 mb-4 px-4">
            <label for="SRrangeBar-s-control" class="col-xl-auto control-label small">推薦難度範圍</label>
            <div class="col-xl-auto flex-grow-1">
              <div class="SRrangeBar">
                <div id="SRrangeBar-s-range" class="SRrangeBar-slider s-range"> </div>
                <div id="SRrangeBar-s-control" class="SRrangeBar-slider s-control" data-popup-enabled="true"> </div>
              </div>
            </div>
          </div>
          <!-- 搜尋  end  --> 
          <!-- 表格 start -->
          <div class="bg-body mx-n3 mb-n3 px-3"> 
            <!-- recommendedBook-list start -->
            <div class="recommendedBook-list">
              <div class="container">
                <table class="table table-borderless table-recommendedBook" id="recommendedBook">
                  <thead>
                    <tr>
                      <th class="row-id">ID</th>
                      <th class="row-good">優選書單</th>
                      <th class="row-cover">書封面</th>
                      <th class="row-bookTitle">書名</th>
                      <th class="row-SR">圖書難度</th>
                      <th class="row-category">分類</th>
                      <th class="row-topicType">題本類別</th>
                      <th class="row-propStatus">命題狀態</th>
                      <th class="row-ebook">電子書</th>
                      <th class="row-tool">立即命題</th>
                      <th class="row-bookplanet">布可星球</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td class="row-id">052c8e4a-e0e4-4074-85b1-848f9f3b4313</td>
                      <td class="row-good"><img src="Content/images/recommendedBook/goodBook.png" width="66" height="65" alt=""></td>
                      <td class="row-cover"><a role="button" class="hover-effect-dark" data-toggle="modal" data-target="#modal-bookIntro"><img src="https://smartreading.net/RP/BookContent/BookFront/16080.jpg"></a></td>
                      <td class="row-bookTitle">能量七密碼：療癒身心靈，喚醒你本有的創造力、直覺和內在力量【附24張圖例】（The Energy Codes： The 7-Step System to Awaken Your Spirit，Heal Your Body，and Live Your Best Life）</td>
                      <td class="row-SR" data-th="圖書難度">SR 999</td>
                      <td class="row-category" data-th="分類">成長/生命教育成長/生命教</td>
                      <td class="row-topicType" data-th="題本類別">摘要題成長/生命教</td>
                      <td class="row-propStatus" data-th="命題狀態">未命題</td>
                      <td class="row-ebook"><img src="Content/images/recommendedBook/icon-ebook-gray.png" width="18" height="18"  alt="">&nbsp;電子書</td>
                      <td class="row-tool"><button class="btn btn-outline-primary px-2" type="button">立即命題</button></td>
                      <td class="row-bookplanet"><img src="Content/images/recommendedBook/borrowLink/bookplanet.png" alt="布可星球"></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <!-- recommendedBook-list end --> 
          </div>
          <!-- 表格  end  --> 
          <!-- ↑跟10重複的地方↑ --> 
        </div>
      </div>
    </div>
  </div>
  <!-- Modal#insertModal 發表新題本及題目  end  --> 
  
  <!-- Modal#quizModal 新增本書題本 / 查看/編輯題本 start -->
  <div class="modal fade modal-quiz" id="quizModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="quizModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered">
      <div class="modal-content rounded-0">
        <div class="modal-header">
          <button type="button" class="btn-close float-start" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body"> 
          <!-- 新增本書題本 / 查看/編輯題本 start -->
          <div class="row mb-3 justify-content-center">
            <h3 class="col-sm-4 text-center h6">新增本書題本 / 查看/編輯題本</h3>
          </div>
          <div class="SRform mb-4 col-lg-10 col-xl-9 mx-auto">
            <div class="row mb-3 align-items-center">
              <label for="modalQuizTitle" class="col-sm-3 col-form-label text-sm-end">題本名稱<span class="text-red">*</span></label>
              <div class="col-sm-8">
                <input type="text" class="form-control rounded-0" id="modalQuizTitle">
              </div>
            </div>
            <!-- -->
			  <div id="sortable">
            <div class="mb-3 row align-items-start modal-quiz-block">
              <button type="button" class="btn-close" aria-label="Close"></button>
              <label for="modalQuizTopic" class="col-sm-3 col-form-label text-sm-end modal-quiz-topic">題目<span class="text-red">*</span></label>
              <div class="col-sm-8">
                <div class="row justify-content-between">
                  <div class="col-auto">
                    <select class="form-select rounded-0 form-select-arrow-sm" id="modalQuizTopic">
                      <option selected disabled>請選擇題型</option>
                      <option value="multiple">選擇題</option>
                      <option value="picture">圖片題</option>
                      <option value="QandA">問答題</option>
                      <option value="video">影片題</option>
                    </select>
                  </div>
                  <div class="col-auto fs-8 modal-quiz-gradingWeight"> 配分
                    <input type="email" class="form-control rounded-0 d-inline me-1" id="" style="width: 50px;">
                    /100分 </div>
                </div>
                <!-- 選擇題 -->
                <div class="multiple">
                  <div class="row mt-3 gx-2">
                    <label for="" class="col-sm-auto col-form-label text-sm-end">題目</label>
                    <div class="col">
                      <input type="text" class="form-control rounded-0" id="">
                    </div>
                  </div>
                  <div class="row mt-3 gx-2">
                    <label for="" class="col-sm-auto col-form-label text-sm-end">答案</label>
                    <div class="col">
                      <div class="row gx-2 mb-1 align-items-center">
                        <div class="col-auto">
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="radioDefault" id="">
                            <label class="form-check-label" for=""> A. </label>
                          </div>
                        </div>
                        <div class="col">
                          <input type="text" class="form-control rounded-0" id="">
                        </div>
                      </div>
                      <div class="row gx-2 mb-1 align-items-center">
                        <div class="col-auto">
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="radioDefault" id="">
                            <label class="form-check-label" for=""> B. </label>
                          </div>
                        </div>
                        <div class="col">
                          <input type="text" class="form-control rounded-0" id="">
                        </div>
                      </div>
                      <div class="row gx-2 mb-1 align-items-center">
                        <div class="col-auto">
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="radioDefault" id="">
                            <label class="form-check-label" for=""> C. </label>
                          </div>
                        </div>
                        <div class="col">
                          <input type="text" class="form-control rounded-0" id="">
                        </div>
                      </div>
                      <div class="row gx-2 mb-1 align-items-center">
                        <div class="col-auto">
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="radioDefault" id="">
                            <label class="form-check-label" for=""> D. </label>
                          </div>
                        </div>
                        <div class="col">
                          <input type="text" class="form-control rounded-0" id="">
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- 圖片題 -->
                <div class="picture">
                  <div class="row mt-3 gx-2">
                    <label for="" class="col-sm-auto col-form-label text-sm-end">題目</label>
                    <div class="col">
                      <input type="text" class="form-control rounded-0" id="">
                    </div>
                  </div>
                  <div class="row mt-3 gx-2">
                    <label for="" class="col-sm-auto col-form-label text-sm-end">說明</label>
                    <div class="col">
                      <textarea class="form-control rounded-0" id="" rows="3"></textarea>
                    </div>
                  </div>
                </div>
                <!-- 問答題 -->
                <div class="QandA">
                  <div class="row mt-3 gx-2">
                    <label for="" class="col-sm-auto col-form-label text-sm-end">題目</label>
                    <div class="col">
                      <input type="text" class="form-control rounded-0" id="">
                    </div>
                  </div>
                  <div class="row mt-3 gx-2">
                    <label for="" class="col-sm-auto col-form-label text-sm-end">說明</label>
                    <div class="col">
                      <textarea class="form-control rounded-0" id="" rows="3"></textarea>
                    </div>
                  </div>
                </div>
                <!-- 影片題 -->
                <div class="video">
                  <div class="row mt-3 gx-2">
                    <label for="" class="col-auto col-form-label text-sm-end">題目</label>
                    <div class="col">
                      <input type="text" class="form-control rounded-0" id="">
                    </div>
                  </div>
                  <div class="row mt-3 gx-2">
                    <label for="" class="col-auto col-form-label text-sm-end">說明</label>
                    <div class="col">
                      <textarea class="form-control rounded-0" id="" rows="3"></textarea>
                    </div>
                  </div>
                </div>
              </div>
            </div>
			</div>	  
            <!-- -->
            <div class="mb-5 row align-items-center">
              <div class="col-sm-3 text-sm-end"></div>
              <div class="col-sm-8 d-flex justify-content-between align-items-center">
                <div class="col-auto modal-quiz-sortableTip"><span class="text-muted fs-8"><i class="SRicon-sorting"></i>題目模塊可拖動調整順序</span></div>
                <div class="col-auto">
                  <button type="button" class="btn btn-primary" id="insertMoreTopic"><i class="fa-solid fa-plus me-1"></i>新增更多題目</button>
                </div>
              </div>
            </div>
            <!-- -->
            <div class="mb-3 row align-items-center">
              <label for="insertPropStatus" class="col-sm-3 col-form-label text-sm-end">命題狀態</label>
              <div class="col-sm-6">
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="insertGender" id="propStatus_1" value="發佈" checked>
                  <label class="form-check-label" for="propStatus_1">發佈</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="insertGender" id="propStatus_0" value="暫不發佈">
                  <label class="form-check-label" for="propStatus_0">暫不發佈</label>
                </div>
              </div>
            </div>
            <!-- -->
            <div class="mb-5 row align-items-start">
              <label for="insertMoreClass" class="col-sm-3 col-form-label text-sm-end" value="zhanghuahua">分派班級</label>
              <div class="col-sm-9"> <span class="modal-quiz-assign">
                <button type="button" class="btn btn-outline-primary bg-gradient me-1 mb-1"><i class="fa-solid fa-xmark me-1"></i>3年1班</button>
                <button type="button" class="btn btn-outline-primary bg-gradient me-1 mb-1"><i class="fa-solid fa-xmark me-1"></i>3年2班</button>
                <button type="button" class="btn btn-outline-primary bg-gradient me-1 mb-1"><i class="fa-solid fa-xmark me-1"></i>3年3班</button>
                <button type="button" class="btn btn-outline-primary bg-gradient me-1 mb-1"><i class="fa-solid fa-xmark me-1"></i>3年5班</button>
                <button type="button" class="btn btn-outline-primary bg-gradient me-1 mb-1"><i class="fa-solid fa-xmark me-1"></i>3年6班</button>
                <button type="button" class="btn btn-outline-primary bg-gradient me-1 mb-1"><i class="fa-solid fa-xmark me-1"></i>3年4班</button>
                </span>
                <button type="button" class="btn btn-primary me-1 mb-1" id="insertMoreClass"><i class="fa-solid fa-plus me-1"></i>新增更多班級</button>
                <div class="bg-primary bg-opacity-10 border border-2 border-dashed p-3 mt-2 modal-quiz-checkbox">
                  <div class="d-flex flex-wrap mb-3">
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="checkbox" value="" id="3年1班">
                      <label class="form-check-label text-primary" for="3年1班"> 3年1班 </label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="checkbox" value="" id="3年2班">
                      <label class="form-check-label text-primary" for="3年2班"> 3年2班 </label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="checkbox" value="" id="3年3班">
                      <label class="form-check-label text-primary" for="3年3班"> 3年3班 </label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="checkbox" value="" id="3年4班">
                      <label class="form-check-label text-primary" for="3年4班"> 3年4班 </label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="checkbox" value="" id="3年5班">
                      <label class="form-check-label text-primary" for="3年5班"> 3年5班 </label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="checkbox" value="" id="3年6班">
                      <label class="form-check-label text-primary" for="3年6班"> 3年6班 </label>
                    </div>
                  </div>
                  <div class="text-center">
                    <button type="button" class="btn btn-outline-primary m-1">取消</button>
                    <button type="button" class="btn btn-primary m-1" id="">確定</button>
                  </div>
                </div>
              </div>
            </div>
            <!-- -->
            <div class="mb-3 row align-items-center">
              <div class="col text-center">
                <button type="button" class="btn btn-outline-primary m-1" data-bs-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary m-1" id="quizConfirm">確定新增</button>
              </div>
            </div>
          </div>
          <!-- 新增本書題本 / 查看/編輯題本  end  --> 
        </div>
      </div>
    </div>
  </div>
  <!-- Modal#quizModal 新增本書題本  end  -->
  
  <footer> </footer>
</form>
<!-- ------- ------- ------- ------- ------- ------- ------- --> 
<!-- ------- ------- ------- ------- ------- ------- ------- --> 
<!-- ------- ------- ------- ------- ------- ------- ------- --> 
<script src="Content/js/jquery-3.6.0.min.js"></script> 

<!-- widgets JS --> 
<script src="Content/js/bootstrap.bundle.min.js"></script> 
<script src="Content/js/doubleScorollbar.js"></script> 
<script src="Content/widgets/DataTables/datatables.min.js"></script> 
<script src="Content/widgets/DataTables/buttons-2.4.2/js/dataTables.buttons.min.js"></script> 
<script src="Content/widgets/DataTables/buttons-2.4.2/js/buttons.html5.min.js"></script> 
<script src="Content/widgets/DataTables/buttons-2.4.2/js/buttons.print.min.js"></script> 
<script src="Content/widgets/bootstrap-select-1.14.0-beta3/dist/js/bootstrap-select.min.js"></script>	

<!-- my JS --> 
<script src="Content/js/main.js"></script> 
<script>
$(document).ready(function() {
    //call header、footer、 sidebar  
    $('header').load('master_header.html', function(){
        //當前頁名稱顯示
        $('#currentPage').text( $('main h2').text() ).addClass('active'); 
    }); 
    $('footer').load('master_footer.html'); 
    $('#sidebarMenu').load('master_sidebar.html', function(){
        //當前頁actvie
        $('#sidebarMenu .nav-link[href*="RP-quiz"]').addClass('active');   
    }); 

	const list = $('#quizTable');
	
    //教師命題 datatables 
	list.DataTable({
        //serverSide: true,     // 開啟伺服端模式
		processing: true,   
        order: [],  //取消默認排序icon
        autoWidth: false,
        responsive: false,
		searching: true,
		pageLength: 10,
		pagingType: "simple_numbers",
        dom: '<"table-responsive"rt>'+
			 '<"datatables-custom-footer"pi>',		
        language: {
          url: 'Content/widgets/DataTables/lang/Chinese-traditional.json'
        },
        ajax: 'Content/json/RP-quiz/quiz.json',
        columnDefs: [
			{//刪除
                targets: 0, 
                title: '刪除',
                className: 'row-delete',
                orderable: false,
                visible: false,
                render: function (data, type, row, meta) {
                    return `<div class="SRform-check-red">
                              <input class="form-check-input" type="checkbox" name="delete">
                            </div>`; 
                } 
            },
            {//序號
                targets: 1, 
                title: '序號',
                className: 'row-index',
                orderable: false,
                render: function (data, type, row, meta) {
                    return meta.row + 1; 
                } 
            },
            {//書名
                targets: 2, 
                title: '書名',
                data: 'bookTitle',
                className: 'row-bookTitle',
                orderable: false, 
            },
            {//ISBN
                targets: 3,
                title: 'ISBN',
                data: 'ISBN',
                className: 'row-ISBN',
                orderable: false,
            },
            {//作者
                targets: 4, 
                title: '作者',
                data: 'author',
                className: 'row-author',
                orderable: false,
            },
            {//題本數
                targets: 5, 
                title: '題本數',
                data: 'quizCount',
                className: 'row-quizCount',
                orderable: false,
            },
            {//題本詳情
                targets: 6, 
                title: '題本詳情',
                className: 'row-quizDetail',
                orderable: false,
                render: function (data, type, row, meta) {
                    return `<button type="button" class="btn btn-link btn-toggle-child">顯示詳情</button>`;
                }
            },
			{//新增本書題本
                targets: 7, 
                title: '新增本書題本',
                className: 'row-quizInsert',
                orderable: false,
                render: function (data, type, row, meta) {
                    return `<button type="button" class="btn btn-primary">新增</button>`;
                }
            }
            
        ],
        initComplete: function() {
            //datatable footer input page
            datatableInputPage(list);
        }
    }); 
	
	//[編輯設定]
    $('#setting').click(function(){
        //功能按鈕區、搜尋區 不可按
        $('#blockBtns, #blockSearch').find('button, input, select').attr('disabled', true);
		
		//頁碼隱藏(僅可編輯目前畫面的資料)
        $('.datatables-custom-footer').hide(); 

        //[編輯設定]-按鈕 顯示
        $('#blockSettingBtns').show(); 
		
		//表格欄位 顯示刪除、隱藏序號
        list.DataTable().column('.row-delete').visible(true); 
        list.DataTable().column('.row-index').visible(false); 
		
		//表格按鈕 不可按
        if (list.find('button').length) {
		  list.find('button').attr('disabled', true);
		}
    });
	
	//[編輯設定]>[取消]
    $('#settingCancel').click(function(){
        //do something... (若有修改資料，則還原為原資料)
        
        //功能按鈕區、搜尋區 可按
        $('#blockBtns, #blockSearch').find('button, input, select').attr('disabled', false);
		
		//頁碼顯示
        $('.datatables-custom-footer').show(); 
		
		//[編輯設定]-按鈕 隱藏
        $('#blockSettingBtns').hide(); 
        
        //表格欄位 隱藏刪除、顯示序號
        list.DataTable().column('.row-delete').visible(false); 
        list.DataTable().column('.row-index').visible(true); 

        //表格按鈕 可按
		if (list.find('button').length) {
		  list.find('button').attr('disabled', false);
		}
    });
	
	//[編輯設定]>[確定修改]
    $('#settingConfirm').click(function(){
		//do something... (修改)
        let editOk = true; //[true | false] [修改成功 | 修改失敗]
        
        if(editOk == true){//修改成功
            let selectedCheckboxes = $('input[type="checkbox"][name="delete"]:checked');
            let selectedCount = selectedCheckboxes.length;
            let selectedClass = selectedCheckboxes.map(function() {
                const tr = $(this).closest('tr');
                const Class = tr.find('td.row-bookList input').val();
                return Class;
            }).get();
        
            if( selectedCount > 0){ //有刪除則跳出確認視窗
                confirmModal('是否確定要刪除書單：<b class="text-red">' + selectedClass.join('、') +'</b>？');
                
                $('#confirmOk').click(function(){
                    //do something... (修改)
                    
                    editOkAlert();    
                });
            }else{
                //do something... (修改)
                
                editOkAlert();
            }
            
            function editOkAlert(){
                alertModal('<div class="text-red">修改成功！</div>');
            
                $('#alertModal').on('hidden.bs.modal', function () {
                    //功能按鈕區、搜尋區 可按
                    $('#blockBtns, #blockSearch').find('button, input, select').attr('disabled', false);
					
					//頁碼顯示
                    $('.datatables-custom-footer').show(); 
					
					//[書單設定]-按鈕 隱藏
                    $('#blockSettingBtns').hide();
					
					//表格欄位 不可編輯
                    list.find('input, select').attr('disabled', true).addClass('readonly');

                    //表格欄位 隱藏刪除、顯示序號
                    list.DataTable().column('.row-delete').visible(false); 
                    list.DataTable().column('.row-index').visible(true); 

                    //表格按鈕 可按
                    if (list.find('button').length) {
					  list.find('button').attr('disabled', false);
					}

                    //若有錯誤紅框，則清除紅框
					if (list.find('.invalid').length) {
					  list.find('.invalid').removeClass('invalid');
					}    
                });    
            }
        }else{//修改失敗 demo
			alertModal('<div class="text-red">書單名稱不可空白</div>', function () {
    			const invalidInputs = list.find(`tbody tr:nth-child(1) .row-bookList input,
												 tbody tr:nth-child(3) .row-bookList input`).addClass('invalid');

				// 如有錯誤欄位 → 捲動至第一個
				if (invalidInputs.length > 0) {
					const firstInvalid = invalidInputs.first();

					$('html, body').animate({
						scrollTop: firstInvalid.offset().top - 120  
					}, 500);
				}
			});
        }
    });
	
	//[發表新題本及題目]
    $('#insert').click(function(){
        $('#insertModal').modal('show');
		
		loadRecommendedBook();
    });
	
	//題本詳情[顯示詳情]
	list.on('click', '.btn-toggle-child', function (){ 
		var tr = $(this).parents('tr');
		var row = list.DataTable().row( tr );

		//toggle 自己
		if (row.child.isShown()) {//當前打開=>關閉自己child及銷毀childTable
			const childTable = $(tr.next()).find('table.dataTable').DataTable();
			
			if (childTable) childTable.destroy();
			row.child.hide();
			$(this).parents('td').removeClass('showChild');
		}else { //當前關閉=>關閉其他child及銷毀childTable
			list.DataTable().rows().every(function () {
				if (this.child.isShown()) {
					const childTable = $(this.child()).find('table.dataTable').DataTable();
					if (childTable) childTable.destroy();
									this.child.hide();
				}
			});
			
			const rowIndex = tr.index();
			
			row.child(format(rowIndex)).show();
			$(this).parents('td').addClass('showChild');
			
			loadQuizDetialTable(rowIndex);
		}
	});
	
	//新增本書題本[新增]
	list.on('click', '.row-quizInsert button', function (){ 
		$('#quizModal').attr('data-modal-type', 'insert').modal('show'); 
		
		$('#quizModal h3').text('新增本書題本');
		$('#quizConfirm').text('確定新增');
		
		iniQuizModal();
	});
}); 
	
function format(rowIndex) {
	return `<table class="table table-bordered table-quiz-detial" id="quizDetialTable_${rowIndex}">
				<thead>
				  <tr>
					<th scope="col" class="row-index">序號</th>
					<th scope="col" class="row-quizTitle">題本名稱</th>
					<th scope="col" class="row-quizCount">題本數</th>
					<th scope="col" class="row-propStatus">命題狀態</th>
					<th scope="col" class="row-assignClassCount">分配班級數</th>
					<th scope="col" class="row-editDate">編輯日期</th>
					<th scope="col" class="row-tool">工具</th>
				  </tr> 
				</thead>
			</table>`;
}	
//[顯示詳情] datatables
function loadQuizDetialTable(rowIndex) {
	const list2 = $(`#quizDetialTable_${rowIndex}`);
	
	if ($.fn.DataTable.isDataTable(list2)) { 
        list2.DataTable().clear().destroy();
        list2.find('tbody').empty();
    }
	
	//班級學生 datatables 
	list2.DataTable({
		//serverSide: true,     // 開啟伺服端模式
		processing: true,   
		order: [],  //取消默認排序icon
		autoWidth: false,
		responsive: false,
		searching: false,
		paging: false,
        dom: '<"table-child-scroller"rt>',	
		language: {
		  url: 'Content/widgets/DataTables/lang/Chinese-traditional.json'
		},
		ajax: 'Content/json/RP-quiz/quiz-detial.json',
		columnDefs: [
			{//序號
				targets: 0, 
                title: '序號',
                className: 'row-index',
                orderable: false,
                render: function (data, type, row, meta) {
                    return meta.row + 1; 
                } 
			},
			{//題本名稱
				targets: 1, 
				title: '題本名稱',
				data: 'quizTitle',
				className: 'row-quizTitle',
				orderable: false, 
			},
			{//題本數
				targets: 2,
				title: '題本數',
				data: 'quizCount',
				className: 'row-quizCount',
				orderable: false,
			},
			{//命題狀態
				targets: 3, 
				title: '命題狀態',
				data: 'propStatus',
				className: 'row-propStatus',
				orderable: false,
			},
			{//分配班級數
				targets: 4, 
				title: '分配班級數',
				data: 'assignClassCount',
				className: 'row-assignClassCount',
				orderable: false,
			},
			{//編輯日期
				targets: 5, 
				title: '編輯日期',
				data: 'editDate',
				className: 'row-editDate',
				orderable: false,
			},
			{//工具
				targets: 6, 
				title: '',
				className: 'row-tool',
				orderable: false,
				render: function (data, type, row, meta) {
					return `<button type="button" class="btn btn-outline-primary bg-gradient">查看/編輯</button>`;
				}
			}

		]
	}); 
	
	//[查看/編輯]
	list2.on('click', '.row-tool button', function (){ 
		$('#quizModal').attr('data-modal-type', 'edit').modal('show'); 
		
		$('#quizModal h3').text('查看/編輯題本');
		$('#quizConfirm').text('儲存題本');
	});
	
	
}	
</script> 

<!-- 發表新題本及題目 SRrangeBar -->
<link rel="stylesheet" type="text/css" href="Content/widgets/jquery-ui-1.12.1.custom/jquery-ui.min.css">
<script src="Content/widgets/jquery-ui-1.12.1.custom/jquery-ui.min.js"></script> 
<script src="Content/widgets/jquery-ui-1.12.1.custom/jquery.ui.touch-punch.min.js"></script> 
<script>
$(function() {
	$( '#SRrangeBar-s-range' ).slider({
		range: true,
      	min: 40,
      	max: 1000,
      	values: [ 310, 520 ],
		disabled: true,
    }).find('.ui-widget-header').append('<span class="slider-min"></span><span class="slider-max"></span>');;
	$('.ui-widget-header .slider-min').text('SR '+$( "#SRrangeBar-s-range" ).slider( "values", 0 ));
	$('.ui-widget-header .slider-max').text('SR '+$( "#SRrangeBar-s-range" ).slider( "values", 1 ));
    
    if( $('.ui-widget-header').width() <= 50 ){
        $('.ui-widget-header').addClass('smallWidth');   
    } 
	
	$( '#SRrangeBar-s-control' ).slider({
		range: true,
      	min: 40,
      	max: 1000,
      	values: [ 350, 650 ],
      	slide: function( event, ui ) {
			$('.ui-slider-handle:nth-of-type(1)').find('.slider-tooltip').text('SR '+ui.values[ 0 ]);
			$('.ui-slider-handle:nth-of-type(2)').find('.slider-tooltip').text('SR '+ui.values[ 1 ]);
		}
    }).find('.ui-slider-handle').append('<span class="slider-tooltip"></span>');
	$('.ui-slider-handle:nth-of-type(1)').find('.slider-tooltip').text('SR '+$( "#SRrangeBar-s-control" ).slider( "values", 0 ));
	$('.ui-slider-handle:nth-of-type(2)').find('.slider-tooltip').text('SR '+$( "#SRrangeBar-s-control" ).slider( "values", 1 ));
 });
</script> 

<!-- 發表新題本及題目 datatables  --> 
<script>
function loadRecommendedBook(json) { 
    const list3 = $('#recommendedBook');
	
	if ($.fn.DataTable.isDataTable(list3)) { 
        list3.DataTable().clear().destroy();
        list3.find('tbody').empty();
    }
	
	list3.DataTable({
        //serverSide: true,
        order: [],  //取消默認排序icon
        autoWidth: false,
        responsive: false,
		searching: true,
		pageLength: 8,
		pagingType: "simple_numbers",
		dom: '<"datatables-custom-header recommendedBook-table-header"Bip>'+
			 '<rt>'+
			 '<"datatables-custom-footer clearfix"pi>',
		buttons:[	
			{
			  text: '圖書難度&nbsp;<span class="glyphicon glyphicon-arrow-up" aria-hidden="true"></span>',
			  attr:  { id: 'sort_SR', class: 'dt-button dt-button-SRsort'},
			  action: function () {
				if( $('#sort_SR').hasClass('asc')){ //原本asc↑，變desc↓
					this.order( [ 4, 'desc' ] ).draw();
					$('#sort_SR').removeClass('active asc desc').addClass('active desc').siblings('.dt-button').removeClass('active asc desc');
					$('#sort_SR').find('.glyphicon').removeClass('glyphicon-arrow-up').addClass('glyphicon-arrow-down');
				}else{//原本null or desc↓變asc↑
					this.order( [ 4, 'asc' ] ).draw();
					$('#sort_SR').removeClass('active asc desc').addClass('active asc').siblings('.dt-button').removeClass('active asc desc');
					$('#sort_SR').find('.glyphicon').removeClass('glyphicon-arrow-down').addClass('glyphicon-arrow-up');
				}//if there has "SR 1000", that will need to debug......
			  }
			},
			{
			  text: `<select id="propStatus" class="form-select form-select-sm form-select-arrow-sm rounded-0">
					   <option value="">命題狀態</option>
					   <option value="未命題">未命題</option>
					   <option value="未發佈">未發佈</option>
					   <option value="已發佈">已發佈</option>
				     </select>`,
			  attr: { id: 'sort_assignStatus', class: 'dt-button dt-button-select' },
			  action: function () { /* 不需要 action */ },
			  init: function (api, node, config) {
			    // 移除 button 樣式
			    $(node).removeClass('dt-button').css({
					padding: 0,
					border: 'none',
					background: 'transparent'
			    });
			    // 綁定事件
			    $(node).find('select').on('change', function () {
			  		const val = $(this).val();

			    });
			  }
			},
			{
			  text:`<img src="Content/images/recommendedBook/icon-goodBook.png" width="18" height="18">&nbsp;優選書優先&nbsp;
					<div class="form-check">
						<input type="checkbox" id="goodBook" class="form-check-input border-primary">
						<label for="goodBook" class="form-check-label"></label>
					</div>`,
			  attr:  { id: 'sort_good', class: 'dt-button dt-button-checkbox'},
			  action: function () {
				if( $('#sort_good').hasClass('desc')){ //原本asc↑，變desc↓
					this.order( [ 0, 'asc' ] ).draw();
					$('#sort_good').removeClass('active asc desc').siblings('.dt-button').removeClass('active asc desc');
					$('#sort_good').find('input[type="checkbox"]').removeAttr('checked');
				}else{//原本null 變desc↑
					this.order( [ 1, 'desc' ] ).draw();
					$('#sort_good').removeClass('active asc desc').addClass('active desc').siblings('.dt-button').removeClass('active asc desc');
					$('#sort_good').find('input[type="checkbox"]').attr('checked', 'checked');
				}
			  }//請改寫，暫以checked="checked"：#sort_good有內容desc排序優選書； checked=""：按原本#sort_id排序
			},
			{
			  text: `<img src="Content/images/recommendedBook/icon-ebook.png" width="18" height="18">&nbsp;電子書&nbsp;
					 <div class="form-check">
						<input type="checkbox" id="ebook" class="form-check-input border-primary">
						<label for="ebook" class="form-check-label"></label>
					 </div>`,
			  attr:  { id: 'sort_ebook', class: 'dt-button dt-button-checkbox'},
			  action: function () {
				  if( $('#sort_ebook').find('input[type="checkbox"]').prop('checked')){
					  $('#sort_ebook').find('input[type="checkbox"]').removeAttr('checked');
					  this.search('').draw(); 
				  }else{
					  $('#sort_ebook').find('input[type="checkbox"]').attr('checked', 'checked');
					  //do something...  
				  }
			  }
			}
		],
        language: {
          url: 'Content/widgets/DataTables/lang/Chinese-traditional.json',
		  info: `<span class="info-total"><span>共&nbsp;</span>_TOTAL_<span>&nbsp;本書</span></span>
				 <span class="info-page" ><span>第&nbsp;</span><strong class="text-red">_PAGE_</strong><span>&nbsp;頁</span>&nbsp;/</span>
				 <span class="info-pages"><span>共&nbsp;</span>_PAGES_<span>&nbsp;頁</span></span>`
        },
        ajax: 'Content/json/RP-quiz/recommendedBook.json',
        columnDefs: [
            {//ID
                targets: 0, 
                title: 'ID',
                className: 'row-id',
                orderable: false,
				visible: false,
                render: function (data, type, row, meta) {
                    return meta.row + 1; 
                } 
            },
            {//優選書單
                targets: 1, 
                title: '優選書單',
                data: 'good',
                className: 'row-good',
                orderable: false, 
                render: function (data, type, row, meta) {
                    let good;
                    switch (data) {
                        case 1:
                            good = `<img src="Content/images/recommendedBook/goodBook.png" width="66" height="65">`;
                            break
                        case 0:
                            good = ``;
                            break    
                        default:
                            good = ``;
                            break 
                    }
                    return good;
                } 
            },
            {//書封面
                targets: 2,
                title: '書封面',
                data: 'cover',
                className: 'row-cover',
                orderable: false,
				render: function (data, type, row, meta) {
                    return `<img src="https://smartreading.net/RP/BookContent/BookFront/`+ data +`">`;
                } 
            },
            {//書名
                targets: 3, 
                title: '書名',
                data: 'bookTitle',
                className: 'row-bookTitle',
                orderable: false,
            },
            {//圖書難度
                targets: 4, 
                title: '圖書難度',
                data: 'SR',
                className: 'row-SR',
                orderable: false,
                render: function (data, type, row, meta) {
                    return `SR `+ data;
                },
				createdCell: function (td, cellData, rowData, row, col) {
					$(td).attr('data-th', '圖書難度');
				}
            },
            {//分類
                targets: 5, 
                title: '分類',
                data: 'category',
                className: 'row-category',
                orderable: false,
				createdCell: function (td, cellData, rowData, row, col) {
					$(td).attr('data-th', '分類');
				}
            },
            {//題本類別
                targets: 6, 
                title: '題本類別',
                data: 'topicType',
                className: 'row-topicType',
                orderable: false,
				createdCell: function (td, cellData, rowData, row, col) {
					$(td).attr('data-th', '題本類別');
				}
            },
			{//命題狀態
                targets: 7, 
                title: '命題狀態',
                data: 'propStatus',
                className: 'row-propStatus',
                orderable: false,
				createdCell: function (td, cellData, rowData, row, col) {
					$(td).attr('data-th', '命題狀態');
				}
            },
			{//電子書
                targets: 8, 
                title: '電子書',
                data: 'ebook',
                className: 'row-ebook',
                orderable: false,
                render: function (data, type, row, meta) {
                    let ebook;
                    switch (data) {
                        case 1:
                            ebook = `<img src="Content/images/recommendedBook/icon-ebook.png" width="18" height="18">&nbsp;電子書`;
                            break
                        case 0:
                            ebook = `<img src="Content/images/recommendedBook/icon-ebook-gray.png" width="18" height="18">&nbsp;電子書`;
                            break    
                        default:
                            ebook = `<img src="Content/images/recommendedBook/icon-ebook-gray.png" width="18" height="18">&nbsp;電子書`;
                            break 
                    }
                    return ebook;
                } 
            },
			{//立即命題
                targets: 9, 
                title: '立即命題',
				data: 'propStatus',
                className: 'row-tool',
                orderable: false,
                render: function (data, type, row, meta) {
					let btn;
					switch (data){
						case "未命題":
							btn = `<button class="btn btn-outline-primary px-2" type="button" data-action="insert">立即命題</button>`;
							break;
						case "未發佈":
							btn = `<button class="btn btn-outline-primary px-2" type="button" data-action="edit">查看命題</button>`;
							break;
						case "已發佈":
							btn = `<button class="btn btn-outline-primary px-2" type="button" data-action="edit">查看命題</button>`;
							break;						
						default:
							btn = `<button class="btn btn-outline-primary px-2" type="button" data-action="insert">立即命題</button>`;
							break;	
					}
					return btn;
                }
            },
			{//布可星球
                targets: 10, 
                title: '布可星球',
                data: 'bookplanet',
                className: 'row-bookplanet',
                orderable: false,
                render: function (data, type, row, meta) {
                    let bookplanet;
                    switch (data) {
                        case 1:
                            bookplanet = `<img src="Content/images/recommendedBook/borrowLink/bookplanet.png">`;
                            break
                        case 0:
                            bookplanet = ``;
                            break    
                        default:
                            bookplanet = ``;
                            break 
                    }
                    return bookplanet;
                } 
            },   
        ],
        initComplete: function() {
            //datatable footer input page
            datatableInputPage(list3);
        }
    });
	
	//[立即命題][查看命題]	
	list3.on('click', '.row-tool button', function () {
		const action = $(this).data('action');  // insert / edit

		$('#insertModal').modal('hide');

		if(action === 'insert') {
			$('#quizModal')
				.attr('data-modal-type', 'insert')
				.modal('show');
			$('#quizModal h3').text('新增本書題本');
			$('#quizConfirm').text('確定新增');
		} 
		else if(action === 'edit') {
			$('#quizModal')
				.attr('data-modal-type', 'edit')
				.modal('show');
			$('#quizModal h3').text('查看/編輯題本');
			$('#quizConfirm').text('儲存題本');
		}
	});
}
</script> 

<!-- 新增本書題本/ 查看/編輯題本  --> 
<script>
function iniQuizModal(){
	// 選擇題型事件
	$(document).on('change', '#modalQuizTopic', function () {
		const $block = $(this).closest('.modal-quiz-block');
		const selectedType = $(this).val();

		// 加上綠底虛線樣式
		$block.addClass('bg-primary-dashed');

		// 顯示關閉按鈕、配分欄、調序提示
		$block.find('.btn-close, .modal-quiz-gradingWeight').show();
		$('.modal-quiz-sortableTip').show();

		// 顯示對應題型
		$block.find('.multiple, .picture, .QandA, .video').hide();
		if (selectedType) $block.find('.' + selectedType).show();
	});
	
	// [新增更多題目]
	$('#insertMoreTopic').on('click', function () {
		const $last = $('.modal-quiz-block').last();
		const $clone = $last.clone();

		// 清空內容
		$clone.find('input[type="text"], textarea').val('');
		$clone.find('input[type="radio"], input[type="checkbox"]').prop('checked', false);
		$clone.find('select').val('請選擇題型');
		$clone.find('.multiple, .picture, .QandA, .video').hide();
		$clone.find('.btn-close, .modal-quiz-gradingWeight').hide();
		$clone.removeClass('bg-primary-dashed');

		// 插入新的區塊
		$('#sortable').append($clone);
		$('#sortable').sortable('refresh');

		// 重新編號
		resetQuizNumber();
	});
	
	// 點擊X刪除題目區塊
	$(document).on('click', '.modal-quiz-block .btn-close', function () {
		const $blocks = $('.modal-quiz-block');
		const $current = $(this).closest('.modal-quiz-block');

		if ($blocks.length === 1) {
			confirmModal('是否確定刪除唯一個題目？');

			// 點擊確定後執行還原初始狀態
			$('#confirmOk').off('click').on('click', function () {
				$current.removeClass('bg-primary-dashed');
				$current.find('input[type="text"], textarea').val('');
				$current.find('input[type="radio"], input[type="checkbox"]').prop('checked', false);
				$current.find('select').val('請選擇題型');
				$current.find('.multiple, .picture, .QandA, .video').hide();
				$current.find('.btn-close, .modal-quiz-gradingWeight').hide();
				$('.modal-quiz-sortableTip').hide();
			});

			return;
		}

		// 多於一個題目 → 正常刪除
		$current.remove();

		// 重新編號
		resetQuizNumber();
	});
	
	
	// 分派班級區塊邏輯
	const $assignBox = $('.modal-quiz-checkbox');
	const $assignBtn = $('#insertMoreClass');
	const $assignContainer = $('.modal-quiz-assign');

	// 初始隱藏
	$assignBtn.prop('disabled', false);
	$assignBox.hide();
	$assignContainer.hide();

	// 點擊「新增更多班級」
	$assignBtn.on('click', function () {
		$(this).prop('disabled', true);
		$assignBox.slideDown(200);
	});

	// checkbox區塊「取消」
	$assignBox.find('button:contains("取消")').on('click', function () {
		$assignBox.slideUp(200);
		$assignBtn.prop('disabled', false);
	});

	// 綠底區塊「確定」
	$assignBox.find('button:contains("確定")').on('click', function () {
		const checked = $assignBox.find('input[type="checkbox"]:checked');
		$assignContainer.empty();

		checked.each(function () {
			const name = $(this).attr('id');
			$assignContainer.append(
			`<button type="button" class="btn btn-outline-primary bg-gradient me-1 mb-1">
			  <i class="fa-solid fa-xmark me-1"></i>${name}</button>`
			);
		});

		if (checked.length) $assignContainer.show();
		else $assignContainer.hide();

		$assignBox.slideUp(200);
		$assignBtn.prop('disabled', false);
	});

	// 點擊班級按鈕刪除自己 & 取消勾選
	$(document).on('click', '.modal-quiz-assign .btn', function () {
		const className = $(this).text().trim();
		$(this).remove();
		$assignBox.find(`#${className}`).prop('checked', false);

		if ($('.modal-quiz-assign .btn').length === 0)
		$('.modal-quiz-assign').hide();
	});
	
	//[確定新增]/[儲存題本]
	$('#quizConfirm').click(function(){
		$('#quizModal').modal('hide');
		alertModal('<div class="text-red">新增成功！</div>');	
	});
}
	
// 重新編號
function resetQuizNumber() {
    $('.modal-quiz-block').each(function (i) {
        $(this).find('.modal-quiz-topic')
               .html(`題目${i + 1}<span class="text-red">*</span>`);
    });
}
</script>
	
<!-- 題本排序 Sortable  --> 
<script src="https://code.jquery.com/ui/1.14.1/jquery-ui.js"></script>
<script> 
$(function () {
    $('#sortable').sortable({
        update: function (event, ui) {
            resetQuizNumber();  // 拖曳排序後重新編號
        }
    });
});	
</script> 	
	
</body>
</html>
