<!doctype html>
<html lang="zh-hant-TW">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="SmartReading 適性閱讀 教師端">
<meta name="author" content="SmartReading">
<meta name="generator" content="SmartReading">
<title>SmartReading 教師端</title>
<link rel="shortcut icon" type="image/x-icon" href="Content/images/favicon.ico">
<!-- google fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,100..900;1,100..900&family=Noto+Sans+TC:wght@100..900&display=swap" rel="stylesheet">

<!-- widgets CSS -->
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">
<link rel="stylesheet" type="text/css" href="Content/widgets/DataTables/datatables.min.css">

<!-- template CSS -->
<link rel="stylesheet" type="text/css" href="Content/css/bootstrap-custom.css">
<link rel="stylesheet" type="text/css" href="Content/css/SRv3-manager.css">
</head>
<body>
<form>
  <header> </header>
  <div class="container-fluid">
    <div class="row">
      <nav id="sidebarMenu" class="col-xl-2 d-xl-block bg-white sidebar collapse"> </nav>
      <main class="col-xl-10"> 
        <!-- ------- ------- ------- ------- ------- ------- ------- -->
        <h2 class="SR-h2"><span>測驗場次管理</span></h2>
        <div class="row py-3 py-xl-5 px-1 px-xl-4"> 
          <!-- 按鈕 start -->
          <div class="col-xxl-5 mb-3" id="blockBtns">
            <button type="button" class="btn btn-outline-primary bg-gradient my-1" id="insert"><i class="fa-solid fa-plus me-1"></i>新增場次</button>
          </div>
          <!-- 按鈕  end  --> 
          <!-- 搜尋 start -->
          <div class="col-xxl-7 mb-3" id="blockSearch">
            <div class="row g-2 align-items-center justify-content-end">
              <div class="col-auto">
                <label for="searchStatus" class="col-form-label fs-7">狀態</label>
              </div>
              <div class="col-auto">
                <select class="form-select rounded-0 form-select-sm form-select-arrow-sm" id="searchStatus">
                  <option value="" selected>全部</option>
                  <option value="ON">ON</option>
                  <option value="OFF">OFF</option>
                </select>
              </div>
              <div class="col-auto d-none d-lg-inline ms-3">
                <label for="searchKeywords" class="col-form-label fs-7">搜尋</label>
              </div>
              <div class="col-auto">
                <div class="input-group">
                  <div class="input-group-clear">
                    <input type="text" class="form-control rounded-0" placeholder="請輸入關鍵字..." aria-label="請輸入關鍵字..." aria-describedby="btnSearch" id="searchKeywords">
                    <button class="btn btn-close" type="button"></button>
                  </div>
                  <button class="btn btn-gray-100 rounded-0 border-gray-400 text-primary lh-1" type="button" id="btnSearch"><i class="fa-solid fa-magnifying-glass fs-5 mx-n1"></i></button>
                </div>
              </div>
            </div>
          </div>
          <!-- 搜尋  end  --> 
          <!-- 表格 start -->
          <div class="col-xl-12 mb-5">
            <table class="table table-bordered table-session" id="sessionTable">
              <thead>
                <tr>
                  <th scope="col" class="col-index">序號</th>
                  <th scope="col" class="col-session">場次</th>
                  <th scope="col" class="col-remark">備註</th>
                  <th scope="col" class="col-startDatetime">開始時間</th>
                  <th scope="col" class="col-endDatetime">結束時間</th>
                  <th scope="col" class="col-testCount">測驗人數</th>
                  <th scope="col" class="col-completedCount">完成人數</th>
                  <th scope="col" class="col-tool">功能操作</th>
                  <th scope="col" class="col-status">狀態</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="col-index">1</td>
                  <td class="col-sessio"><input type="text" class="form-control rounded-0 readonly" value="2020-21" disabled readonly></td>
                  <td class="col-remark"><input type="text" class="form-control rounded-0 readonly" value="淡水國小" disabled readonly></td>
                  <td class="col-startDatetime">2020/09/01 08:00</td>
                  <td class="col-endDatetime">2020/12/31 17:30</td>
                  <td class="col-testCount">22</td>
                  <td class="col-completedCount">22</td>
                  <td class="col-tool"><button type="button" class="btn btn-outline-primary bg-gradient my-1 px-1 btn-session-studentSet" data-bs-toggle="tooltip"><img src="Content/images/icon-user-add.svg" alt="設定學生"/></button>
                    <button type="button" class="btn btn-outline-primary bg-gradient my-1 px-1 btn-session-studentLists" data-bs-toggle="tooltip"><img src="Content/images/icon-paper.svg" alt="學生名單"/></button>
                    <button type="button" class="btn btn-outline-primary bg-gradient my-1 px-1 btn-session-sessionSet" data-bs-toggle="tooltip"><img src="Content/images/icon-tool.svg" alt="場次設定"/></button></td>
                  <td class="col-status"><div class="form-check form-switch">
                      <input class="form-check-input" type="checkbox" role="switch">
                    </div></td>
                </tr>
              </tbody>
            </table>
          </div>
          <!-- 表格  end  --> 
          <!-- [修改資料]-訊息 start -->
          <div class="col-xl-12 text-center text-red fs-8 mb-2" id="blockEditMsg"> 
            <!--錯誤訊息在這--> 
          </div>
          <!-- [修改資料]-訊息  end  --> 
          <!-- [修改資料]-按鈕 start -->
          <div class="col-xl-12 text-center mb-5" id="blockEditBtns" style="display: none;">
            <div>
              <button type="button" class="btn btn-outline-primary m-1" id="editCancel">取消</button>
              <button type="button" class="btn btn-primary m-1" id="editOk">確定修改</button>
            </div>
          </div>
          <!-- [修改資料]-按鈕  end  --> 
        </div>
        <!-- ------- ------- ------- ------- ------- ------- ------- --> 
      </main>
    </div>
  </div>
  
  <!-- Modal#insertModal 新增場次 start -->
  <div class="modal fade" id="insertModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="insertModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content rounded-0">
        <div class="modal-header">
          <button type="button" class="btn-close float-start" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body"> 
          <!-- 新增場次 start -->
          <div class="mb-3 row">
            <h3 class="text-center h6">新增場次</h3>
          </div>
          <div class="SRform mb-4 col-lg-10 mx-auto" id="">
            <div class="mb-3 row align-items-center">
              <label for="insertSessionName" class="col-sm-4 col-form-label text-sm-end">場次名稱<span class="text-red">*</span></label>
              <div class="col-sm-6">
                <input type="text" class="form-control rounded-0" id="insertSessionName">
              </div>
            </div>
            <div class="mb-3 row align-items-center">
              <label for="insertRemark" class="col-sm-4 col-form-label text-sm-end" value="zhanghuahua">場次備註</label>
              <div class="col-sm-6">
                <input type="text" class="form-control rounded-0" id="insertRemark">
              </div>
            </div>
            <div class="mb-3 row align-items-center">
              <label for="insertStartDatetime" class="col-sm-4 col-form-label text-sm-end">開始時間<span class="text-red">*</span></label>
              <div class="col-sm-6">
                <input type="datetime-local" class="form-control rounded-0" id="insertStartDatetime">
              </div>
            </div>
            <div class="mb-3 row align-items-center">
              <label for="insertEndDatetime" class="col-sm-4 col-form-label text-sm-end">結束時間<span class="text-red">*</span></label>
              <div class="col-sm-6">
                <input type="datetime-local" class="form-control rounded-0" id="insertEndDatetime">
              </div>
            </div>
            <div class="mb-3 row align-items-center">
              <label for="insertStatus" class="col-sm-4 col-form-label text-sm-end">狀態</label>
              <div class="col-sm-6">
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" role="switch">
                </div>
              </div>
            </div>
            <div class="mb-3 row align-items-center">
              <div class="col-sm-6 offset-sm-4">
                <div class="text-red text-center fs-8 mb-n2" id="insertSessionMsg"> 
                  <!--錯誤訊息在這--> 
                </div>
              </div>
            </div>
            <div class="mb-3 row align-items-center">
              <div class="col-sm-6 offset-sm-4 text-center">
                <button type="button" class="btn btn-outline-primary m-1" data-bs-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary m-1" id="insertSession">確定新增</button>
              </div>
            </div>
          </div>
          <!-- 新增場次  end  --> 
        </div>
      </div>
    </div>
  </div>
  <!-- Modal#insertModal 新增場次  end  --> 
  
  <!-- Modal#studentSetModal 設定學生 start -->
  <div class="modal fade" id="studentSetModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="studentSetModal" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content rounded-0">
        <div class="modal-header">
          <button type="button" class="btn-close float-start" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="row px-2 justify-content-center"> 
            <!-- 設定學生 start -->
            <div class="mb-3 row">
              <h3 class="text-center h6">設定學生</h3>
            </div>
            <!-- 手風琴 start -->
            <div class="col-xl-12  mb-5">
              <div class="accordion SRaccordion accordion-StudentSet" id="accordionStudentSet">
                <div class="accordion-item">
                  <h4 class="accordion-header">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#grade5" aria-expanded="true" aria-controls="grade5"> 5年級 </button>
                  </h4>
                  <div id="grade5" class="accordion-collapse collapse show" data-bs-parent="#accordionStudentSet">
                    <div class="accordion-body p-0">
                      <div class="table-responsive">
                        <table class="table table-bordered mb-0 table-studentSet" id="grade5-class2">
                          <thead>
                            <tr>
                              <th scope="col" class="col-classCheck"> <div class="form-check form-check-inline form-check-red">
                                  <input class="form-check-input" type="checkbox" id="checkAll-grade5-class2" name="checkAll">
                                </div>
                                <button class="btn btn-link p-0" type="button" data-bs-toggle="collapse" data-bs-target="#grade5-class2-body" aria-expanded="true" aria-controls="grade5-class2-body">2班</button>
                              </th>
                              <th scope="col" class="col-studentName">姓名</th>
                              <th scope="col" class="col-studentId">學號</th>
                              <th scope="col" class="col-account">帳號/信箱</th>
                            </tr>
                          </thead>
                          <tbody class="collapse show" id="grade5-class2-body">
                            <tr>
                              <td class="col-classCheck"><div class="form-check form-check-inline form-check-red">
                                  <input class="form-check-input" type="checkbox" name="check" id="">
                                </div></td>
                              <td class="col-studentName"><input type="text" class="form-control rounded-0 readonly" value="張花花" disabled readonly></td>
                              <td class="col-studentId"><input type="text" class="form-control rounded-0 readonly" value="2020153" disabled readonly></td>
                              <td class="col-account"><input type="text" class="form-control rounded-0 readonly" value="srtt01@smartreading.com" disabled readonly></td>
                            </tr>
                            <tr>
                              <td class="col-classCheck"><div class="form-check form-check-inline form-check-red">
                                  <input class="form-check-input" type="checkbox" name="check">
                                </div></td>
                              <td class="col-studentName"><input type="text" class="form-control rounded-0 readonly" value="張花花" disabled readonly></td>
                              <td class="col-studentId"><input type="text" class="form-control rounded-0 readonly" value="2020153" disabled readonly></td>
                              <td class="col-account"><input type="text" class="form-control rounded-0 readonly" value="srtt01@smartreading.com" disabled readonly></td>
                            </tr>
                            <tr>
                              <td class="col-classCheck"><div class="form-check form-check-inline form-check-red">
                                  <input class="form-check-input" type="checkbox" name="check">
                                </div></td>
                              <td class="col-studentName"><input type="text" class="form-control rounded-0 readonly" value="張花花" disabled readonly></td>
                              <td class="col-studentId"><input type="text" class="form-control rounded-0 readonly" value="2020153" disabled readonly></td>
                              <td class="col-account"><input type="text" class="form-control rounded-0 readonly" value="srtt01@smartreading.com" disabled readonly></td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <div class="table-responsive">
                        <table class="table table-bordered mb-0 table-studentSet" id="grade5-class3">
                          <thead>
                            <tr>
                              <th scope="col" class="col-classCheck"> <div class="form-check form-check-inline form-check-red">
                                  <input class="form-check-input" type="checkbox" id="checkAll-grade5-class3" name="checkAll">
                                  <button class="btn btn-link p-0" type="button" data-bs-toggle="collapse" data-bs-target="#grade5-class3-body" aria-expanded="true" aria-controls="grade5-class2-body">3班</button>
                                </div>
                              </th>
                              <th scope="col" class="col-studentName">姓名</th>
                              <th scope="col" class="col-studentId">學號</th>
                              <th scope="col" class="col-account">帳號/信箱</th>
                            </tr>
                          </thead>
                          <tbody class="collapse show" id="grade5-class3-body">
                            <tr>
                              <td class="col-classCheck"><div class="form-check form-check-inline form-check-red">
                                  <input class="form-check-input" type="checkbox" name="check" id="">
                                </div></td>
                              <td class="col-studentName"><input type="text" class="form-control rounded-0 readonly" value="張花花" disabled readonly></td>
                              <td class="col-studentId"><input type="text" class="form-control rounded-0 readonly" value="2020153" disabled readonly></td>
                              <td class="col-account"><input type="text" class="form-control rounded-0 readonly" value="srtt01@smartreading.com" disabled readonly></td>
                            </tr>
                            <tr>
                              <td class="col-classCheck"><div class="form-check form-check-inline form-check-red">
                                  <input class="form-check-input" type="checkbox" name="check">
                                </div></td>
                              <td class="col-studentName"><input type="text" class="form-control rounded-0 readonly" value="張花花" disabled readonly></td>
                              <td class="col-studentId"><input type="text" class="form-control rounded-0 readonly" value="2020153" disabled readonly></td>
                              <td class="col-account"><input type="text" class="form-control rounded-0 readonly" value="srtt01@smartreading.com" disabled readonly></td>
                            </tr>
                            <tr>
                              <td class="col-classCheck"><div class="form-check form-check-inline form-check-red">
                                  <input class="form-check-input" type="checkbox" name="check">
                                </div></td>
                              <td class="col-studentName"><input type="text" class="form-control rounded-0 readonly" value="張花花" disabled readonly></td>
                              <td class="col-studentId"><input type="text" class="form-control rounded-0 readonly" value="2020153" disabled readonly></td>
                              <td class="col-account"><input type="text" class="form-control rounded-0 readonly" value="srtt01@smartreading.com" disabled readonly></td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="accordion-item">
                  <h4 class="accordion-header">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#grade4" aria-expanded="false" aria-controls="grade4"> 4年級 </button>
                  </h4>
                  <div id="grade4" class="accordion-collapse collapse" data-bs-parent="#accordionStudentSet">
                    <div class="accordion-body p-0">
                      <div class="table-responsive">
                        <table class="table table-bordered mb-0 table-studentSet" id="grade4-class1">
                          <thead>
                            <tr>
                              <th scope="col" class="col-classCheck"> <div class="form-check form-check-inline form-check-red">
                                  <input class="form-check-input" type="checkbox" id="checkAll-grade4-class1" name="checkAll">
                                </div>
                                <button class="btn btn-link p-0" type="button" data-bs-toggle="collapse" data-bs-target="#grade4-class1-body" aria-expanded="true" aria-controls="grade4-class1-body">1班</button>
                              </th>
                              <th scope="col" class="col-studentName">姓名</th>
                              <th scope="col" class="col-studentId">學號</th>
                              <th scope="col" class="col-account">帳號/信箱</th>
                            </tr>
                          </thead>
                          <tbody class="collapse show" id="grade4-class1-body">
                            <tr>
                              <td class="col-classCheck"><div class="form-check form-check-inline form-check-red">
                                  <input class="form-check-input" type="checkbox" name="check" id="">
                                </div></td>
                              <td class="col-studentName"><input type="text" class="form-control rounded-0 readonly" value="張花花" disabled readonly></td>
                              <td class="col-studentId"><input type="text" class="form-control rounded-0 readonly" value="2020153" disabled readonly></td>
                              <td class="col-account"><input type="text" class="form-control rounded-0 readonly" value="srtt01@smartreading.com" disabled readonly></td>
                            </tr>
                            <tr>
                              <td class="col-classCheck"><div class="form-check form-check-inline form-check-red">
                                  <input class="form-check-input" type="checkbox" name="check">
                                </div></td>
                              <td class="col-studentName"><input type="text" class="form-control rounded-0 readonly" value="張花花" disabled readonly></td>
                              <td class="col-studentId"><input type="text" class="form-control rounded-0 readonly" value="2020153" disabled readonly></td>
                              <td class="col-account"><input type="text" class="form-control rounded-0 readonly" value="srtt01@smartreading.com" disabled readonly></td>
                            </tr>
                            <tr>
                              <td class="col-classCheck"><div class="form-check form-check-inline form-check-red">
                                  <input class="form-check-input" type="checkbox" name="check">
                                </div></td>
                              <td class="col-studentName"><input type="text" class="form-control rounded-0 readonly" value="張花花" disabled readonly></td>
                              <td class="col-studentId"><input type="text" class="form-control rounded-0 readonly" value="2020153" disabled readonly></td>
                              <td class="col-account"><input type="text" class="form-control rounded-0 readonly" value="srtt01@smartreading.com" disabled readonly></td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <div class="table-responsive">
                        <table class="table table-bordered mb-0 table-studentSet" id="grade4-class2">
                          <thead>
                            <tr>
                              <th scope="col" class="col-classCheck"> <div class="form-check form-check-inline form-check-red">
                                  <input class="form-check-input" type="checkbox" id="checkAll-grade4-class2" name="checkAll">
                                  <button class="btn btn-link p-0" type="button" data-bs-toggle="collapse" data-bs-target="#grade4-class2-body" aria-expanded="true" aria-controls="grade4-class2-body">2班</button>
                                </div>
                              </th>
                              <th scope="col" class="col-studentName">姓名</th>
                              <th scope="col" class="col-studentId">學號</th>
                              <th scope="col" class="col-account">帳號/信箱</th>
                            </tr>
                          </thead>
                          <tbody class="collapse show" id="grade4-class2-body">
                            <tr>
                              <td class="col-classCheck"><div class="form-check form-check-inline form-check-red">
                                  <input class="form-check-input" type="checkbox" name="check" id="">
                                </div></td>
                              <td class="col-studentName"><input type="text" class="form-control rounded-0 readonly" value="張花花" disabled readonly></td>
                              <td class="col-studentId"><input type="text" class="form-control rounded-0 readonly" value="2020153" disabled readonly></td>
                              <td class="col-account"><input type="text" class="form-control rounded-0 readonly" value="srtt01@smartreading.com" disabled readonly></td>
                            </tr>
                            <tr>
                              <td class="col-classCheck"><div class="form-check form-check-inline form-check-red">
                                  <input class="form-check-input" type="checkbox" name="check">
                                </div></td>
                              <td class="col-studentName"><input type="text" class="form-control rounded-0 readonly" value="張花花" disabled readonly></td>
                              <td class="col-studentId"><input type="text" class="form-control rounded-0 readonly" value="2020153" disabled readonly></td>
                              <td class="col-account"><input type="text" class="form-control rounded-0 readonly" value="srtt01@smartreading.com" disabled readonly></td>
                            </tr>
                            <tr>
                              <td class="col-classCheck"><div class="form-check form-check-inline form-check-red">
                                  <input class="form-check-input" type="checkbox" name="check">
                                </div></td>
                              <td class="col-studentName"><input type="text" class="form-control rounded-0 readonly" value="張花花" disabled readonly></td>
                              <td class="col-studentId"><input type="text" class="form-control rounded-0 readonly" value="2020153" disabled readonly></td>
                              <td class="col-account"><input type="text" class="form-control rounded-0 readonly" value="srtt01@smartreading.com" disabled readonly></td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- 手風琴  end  --> 
            <!-- 設定學生  end  --> 
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Modal#studentSetModal 設定學生  end  --> 
  
  <!-- Modal#studentListsModal 學生名單 start -->
  <div class="modal fade" id="studentListsModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="studentListsModal" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content rounded-0">
        <div class="modal-header">
          <button type="button" class="btn-close float-start" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="row px-2 justify-content-center"> 
            <!-- 學生名單 start -->
            <div class="mb-3 row">
              <h3 class="text-center h6">學生名單</h3>
            </div>
            <!-- 搜尋 start -->
            <div class="col-xl-12 mb-3">
              <div class="row g-2 align-items-center">
                <div class="col-auto me-auto"> <span class="fs-7 fw-semibold">場次：
                  <label>2020-21</label>
                  </span> </div>
                <div class="col-auto ms-auto">
                  <div class="row g-2">
                    <div class="col-auto d-none d-lg-inline ms-3">
                      <label for="searchKeywords_studentLists" class="col-form-label fs-7">搜尋</label>
                    </div>
                    <div class="col-auto">
                      <div class="input-group">
                        <div class="input-group-clear">
                          <input type="text" class="form-control rounded-0" placeholder="請輸入關鍵字..." aria-label="請輸入關鍵字..." aria-describedby="btnSearch_studentLists" id="searchKeywords_studentLists">
                          <button class="btn btn-close" type="button"></button>
                        </div>
                        <button class="btn btn-gray-100 rounded-0 border-gray-400 text-primary lh-1" type="button" id="btnSearch_studentLists"><i class="fa-solid fa-magnifying-glass fs-5 mx-n1"></i></button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- 搜尋  end  --> 
            <!-- 勾選 start -->
            <div class="col-xl-12 mb-3">
              <div class="form-check form-check-inline me-3 fs-7">
                <input class="form-check-input" type="checkbox" name="showList" id="showList-all" value="" checked>
                <label class="form-check-label" for="showList-all">顯示所有名單</label>
              </div>
              <div class="form-check form-check-inline me-3 fs-7">
                <input class="form-check-input" type="checkbox" name="showList" id="showList-done" value="<span>完成</span>">
                <label class="form-check-label" for="showList-done">僅顯示完成名單</label>
              </div>
              <div class="form-check form-check-inline me-3 fs-7">
                <input class="form-check-input" type="checkbox" name="showList" id="showList-undone" value="<span class='text-red'>未完成</span>">
                <label class="form-check-label" for="showList-undone">僅顯示未完成名單</label>
              </div>
            </div>
            <!-- 勾選  end  --> 
            <!-- 表格 start -->
            <div class="col-xl-12">
              <div class="table-responsive">
                <table class="table table-bordered table-sessionStudentList" id="sessionStudentList">
                  <thead>
                    <tr>
                      <th scope="col" class="col-index">序號</th>
                      <th scope="col" class="col-grade">年級</th>
                      <th scope="col" class="col-class">班級</th>
                      <th scope="col" class="col-studentName">姓名</th>
                      <th scope="col" class="col-studentId">學號</th>
                      <th scope="col" class="col-account">帳號/信箱</th>
                      <th scope="col" class="col-status">狀態</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td class="col-index">1</td>
                      <td class="col-grade"><input type="text" class="form-control rounded-0 readonly" value="5" disabled readonly></td>
                      <td class="col-class"><input type="text" class="form-control rounded-0 readonly" value="Test 01" disabled readonly></td>
                      <td class="col-studentName"><input type="text" class="form-control rounded-0 readonly" value="張花花" disabled readonly></td>
                      <td class="col-studentId"><input type="text" class="form-control rounded-0 readonly" value="2020153" disabled readonly></td>
                      <td class="col-account"><input type="text" class="form-control rounded-0 readonly" value="srtt01@smartreading.com" disabled readonly></td>
                      <td class="col-status"><span class="text-red">未完成</span></td>
                    </tr>
                    <tr>
                      <td class="col-index">2</td>
                      <td class="col-grade"><input type="text" class="form-control rounded-0 readonly" value="5" disabled readonly></td>
                      <td class="col-class"><input type="text" class="form-control rounded-0 readonly" value="Test 01" disabled readonly></td>
                      <td class="col-studentName"><input type="text" class="form-control rounded-0 readonly" value="張花花" disabled readonly></td>
                      <td class="col-studentId"><input type="text" class="form-control rounded-0 readonly" value="2020153" disabled readonly></td>
                      <td class="col-account"><input type="text" class="form-control rounded-0 readonly" value="srtt01@smartreading.com" disabled readonly></td>
                      <td class="col-status"><span>完成</span></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <!-- 表格  end  --> 
            <!-- 學生名單  end  --> 
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Modal#studentListsModal 學生名單  end  --> 
  
  <!-- Modal#sessionSetModal 場次設定 start -->
  <div class="modal fade" id="sessionSetModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="sessionSetModal" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content rounded-0">
        <div class="modal-header">
          <button type="button" class="btn-close float-start" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="row px-2 justify-content-center"> 
            <!-- 場次設定 start -->
            <div class="mb-3 row">
              <h3 class="text-center h6">場次設定</h3>
            </div>
            <div class="SRform mb-4 col-lg-10 mx-auto" id="">
              <div class="mb-3 row align-items-center">
                <label for="updateSessionName" class="col-sm-4 col-form-label text-sm-end">場次名稱<span class="text-red">*</span></label>
                <div class="col-sm-6">
                  <input type="text" class="form-control rounded-0" id="updateSessionName" value="2020-21">
                </div>
              </div>
              <div class="mb-3 row align-items-center">
                <label for="updateRemark" class="col-sm-4 col-form-label text-sm-end" value="zhanghuahua">場次備註</label>
                <div class="col-sm-6">
                  <input type="text" class="form-control rounded-0" id="updateRemark" value="淡水國小">
                </div>
              </div>
              <div class="mb-3 row align-items-center">
                <label for="updateStartDatetime" class="col-sm-4 col-form-label text-sm-end">開始時間<span class="text-red">*</span></label>
                <div class="col-sm-6">
                  <input type="datetime-local" class="form-control rounded-0" id="updateStartDatetime" value="2012-09-01T08:00">
                </div>
              </div>
              <div class="mb-3 row align-items-center">
                <label for="updateEndDatetime" class="col-sm-4 col-form-label text-sm-end">結束時間<span class="text-red">*</span></label>
                <div class="col-sm-6">
                  <input type="datetime-local" class="form-control rounded-0" id="updateEndDatetime" value="2012-09-02T17:30">
                </div>
              </div>
              <div class="mb-3 row align-items-center">
                <label for="updateStatus" class="col-sm-4 col-form-label text-sm-end">狀態</label>
                <div class="col-sm-6">
                  <div class="form-check form-switch">
                    <input class="form-check-input" type="checkbox" role="switch" id="updateStatus">
                  </div>
                </div>
              </div>
              <div class="mb-3 row align-items-center">
                <div class="col-sm-6 offset-sm-4">
                  <div class="text-red text-center fs-8 mb-n2" id="updateSessionMsg"> 
                    <!--錯誤訊息在這--> 
                  </div>
                </div>
              </div>
              <div class="mb-3 row align-items-center">
                <div class="col-sm-6 offset-sm-4 text-center">
                  <button type="button" class="btn btn-outline-primary m-1" data-bs-dismiss="modal">取消</button>
                  <button type="button" class="btn btn-primary m-1" id="updateSession">儲存設定</button>
                </div>
              </div>
            </div>
            <!-- 場次設定  end  --> 
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Modal#sessionSetModal 場次設定  end  -->
  
  <footer> </footer>
</form>
<!-- ------- ------- ------- ------- ------- ------- ------- --> 
<!-- ------- ------- ------- ------- ------- ------- ------- --> 
<!-- ------- ------- ------- ------- ------- ------- ------- --> 
<script src="Content/js/jquery-3.6.0.min.js"></script> 

<!-- widgets JS --> 
<script src="Content/js/bootstrap.bundle.min.js"></script> 
<script src="Content/js/doubleScorollbar.js"></script> 
<script src="Content/widgets/DataTables/datatables.min.js"></script> 
<script src="Content/widgets/DataTables/buttons-2.4.2/js/dataTables.buttons.min.js"></script> 
<script src="Content/widgets/DataTables/buttons-2.4.2/js/buttons.html5.min.js"></script> 
<script src="Content/widgets/DataTables/buttons-2.4.2/js/buttons.print.min.js"></script> 
<script src="Content/widgets/bootstrap-select-1.14.0-beta3/dist/js/bootstrap-select.min.js"></script> 

<!-- my JS --> 
<script src="Content/js/main.js"></script> 
<script>
$(document).ready(function () {
  //call header、footer、 sidebar  
  $('header').load('master_header.html', function () {
    //當前頁名稱顯示
    $('#currentPage').html($('main .SR-h2').html());
  });
	
  $('footer').load('master_footer.html');
	
  $('#sidebarMenu').load('master_sidebar.html', function () {
    //當前頁actvie
    $('#sidebarMenu .nav-link[href*="DACC-session"]').addClass('active');
  });

	
  const $table = $('#sessionTable');

  //測驗場次 datatables 
  $table.DataTable({
    //serverSide: true,     // 開啟伺服端模式
    processing: true,
    order: [], //取消默認排序icon
    ordering: false,
    autoWidth: false,
    responsive: false,
    searching: true,
    pageLength: 10,
    pagingType: "simple_numbers",
    dom: '<rt>'
      + '<"datatables-custom-footer"pi>',
    language: {
      url: 'Content/widgets/DataTables/lang/Chinese-traditional.json'
    },
    ajax: 'Content/json/DACC-session/session.json',
    columnDefs: [{ //序號
        targets: 0,
        title: '序號',
        width: '4%',
        className: 'col-index',
        type: 'numeric',
        render: function (data, type, row, meta) {
          return meta.row + 1;
        }
      },
      { //場次
        targets: 1,
        title: '場次',
        data: 'session',
        width: '12%',
        className: 'col-session',
        type: 'string',
        render: function (data, type, row, meta) {
          return `<input type="text" class="form-control rounded-0 readonly" value="` + data + `" disabled readonly>`;
        }
      },
      { //備註
        targets: 2,
        title: '備註',
        data: 'remark',
        width: '12%',
        className: 'col-remark',
        type: 'string',
        render: function (data, type, row, meta) {
          return `<input type="text" class="form-control rounded-0 readonly" value="` + data + `" disabled readonly>`;
        }
      },
      { //開始時間 
        targets: 3,
        title: '開始時間',
        data: 'startDatetime',
        width: '16%',
        className: 'col-startDatetime',
        type: 'date',
      },
      { //結束時間
        targets: 4,
        title: '結束時間',
        data: 'endDatetime',
        width: '16%',
        className: 'col-endDatetime',
        type: 'date',
      },
      { //測驗人數
        targets: 5,
        title: '測驗人數',
        data: 'testCount',
        width: '8%',
        className: 'col-testCount',
        type: 'numeric',
      },
      { //完成人數
        targets: 6,
        title: '完成人數',
        data: 'completedCount',
        width: '8%',
        className: 'col-completedCount',
        type: 'numeric',
      },
      { //功能操作
        targets: 7,
        title: '功能操作',
        width: '14%',
        className: 'col-tool',
        type: 'html',
        render: function (data, type, row, meta) {
          return `<button type="button" class="btn btn-outline-primary bg-gradient my-1 px-1 btn-session-studentSet" data-bs-toggle="tooltip"><img src="Content/images/icon-user-add.svg" alt="設定學生"/></button>
                  <button type="button" class="btn btn-outline-primary bg-gradient my-1 px-1 btn-session-studentLists" data-bs-toggle="tooltip"><img src="Content/images/icon-paper.svg" alt="學生名單"/></button>
                  <button type="button" class="btn btn-outline-primary bg-gradient my-1 px-1 btn-session-sessionSet" data-bs-toggle="tooltip"><img src="Content/images/icon-tool.svg" alt="場次設定"/></button>`;
        }
      },
      { //狀態
        targets: 8,
        title: '狀態',
        data: 'status',
        width: '10%',
        className: 'col-status',
        type: 'html',
        render: function (data, type, row, meta) {
          let status;
          switch (data) {
            case 'ON':
              status = `<div class="form-check form-switch form-check-inline m-0">
                                        <input class="form-check-input readonly" type="checkbox" role="switch" checked disabled>
                                      </div>`;
              break
            case 'OFF':
              status = `<div class="form-check form-switch form-check-inline m-0">
                                        <input class="form-check-input readonly" type="checkbox" role="switch" disabled>
                                      </div>`;
              break
            default:
              status = '';
              break
          }
          return status;
        }
      }
    ],
    initComplete: function () {
      //datatable footer input page
      datatableInputPage($table);

      //Enable tooltips
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]');
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl, {
        placement: 'bottom',
        title: function () {
          if ($(this).hasClass('btn-session-studentSet')) {
            return '設定學生';
          } else if ($(this).hasClass('btn-session-studentLists')) {
            return '學生名單';
          } else if ($(this).hasClass('btn-session-sessionSet')) {
            return '場次設定';
          }
        }
      }));
    }
  });

  //[搜尋]
  $('#btnSearch').click(function () {
    console.log($('#searchKeywords').val());
    $table.DataTable().search($('#searchKeywords').val()).draw();
  });
  //[搜尋][X]重置
  $('#searchKeywords + .btn-close').click(function () {
    $table.DataTable().search('').draw();
  });

  //[新增場次]
  $('#insert').click(function () {
    $('#insertModal').modal('show');
  });
  //[新增場次]-[確定新增]
  $('#insertSession').click(function () {
    let insertOk = true; //[true | false] [成功 | 失敗]

    //demo驗證
    let errorText = '';
    let validationField = '#insertSessionName, #insertStartDatetime, #insertEndDatetime';

    //demo偵測欄位是否為空值
    $(validationField).each(function () {
      if ($(this).val().trim() == '') {
        $(this).addClass('empty invalid');
      } else {
        $(this).removeClass('empty invalid');
      }
    });

    //demo錯誤訊息內容
    if ($(validationField).hasClass('empty')) {
      errorText += '*號為必填欄位<br>';
    }

    //demo是否有錯誤訊息、驗證是否成功
    if (errorText != '') {
      insertOk = false;
    } else {
      insertOk = true;
    }

    if (insertOk == true) { //新增成功
      $('#insertSessionMsg').html('');
      $('#insertModal').find('input, select').removeClass('empty invalid');

      alertModal('<div class="text-red">新增成功！</div>');

      $('#alertModal').on('hidden.bs.modal', function () {
        //清空表單
        $('#insertModal').find('input, select').val('');
        $('#insertModal').find('input[type="radio"]').prop('checked', false);

        $('#insertBat').attr('disabled', true);
      });
    } else { //新增失敗
      $('#insertSessionMsg').html(errorText);
    }
  });

  /////////////////////////////////////////////////

  //[設定學生]
  $table.on('click', '.btn-session-studentSet', function () {
    $('#studentSetModal').modal('show');

    //do something... (取得sessionLists行列項目資料)

    $('#studentSetModal').on('shown.bs.modal', function () {
      loadStudentSetDOM();
    });
  });

	// [設定學生] DOM
	function loadStudentSetDOM() {
		$.getJSON('Content/json/DACC-session/studentSet.json', function (res) {

			const gradeArray = res.data;
			let accordionHTML = '';

			gradeArray.forEach((gradeObj, gIdx) => {

				const grade = gradeObj.grade;
				const gradeId = `grade${grade}`;
				const showGrade = gIdx === 0 ? 'show' : '';
				const collapsed = gIdx === 0 ? '' : 'collapsed';

				let tableHTML = '';

				// ===== 班級 =====
				gradeObj.table.forEach((cls, cIdx) => {

					const classIndex = cIdx + 1;

					const tableId = `${gradeId}-class${classIndex}`;
					const bodyId = `${tableId}-body`;
					const checkAllId = `checkAll-${tableId}`;

					let studentRows = '';

					// ===== 學生 =====
					cls.students.forEach(stu => {
						studentRows += `
							<tr>
								<td class="col-classCheck">
									<div class="form-check form-check-inline form-check-red">
										<input class="form-check-input" type="checkbox" name="check">
									</div>
								</td>
								<td class="col-studentName">
									<input type="text" class="form-control rounded-0 readonly" value="${stu.studentName}" disabled readonly>
								</td>
								<td class="col-studentId">
									<input type="text" class="form-control rounded-0 readonly" value="${stu.Sid}" disabled readonly>
								</td>
								<td class="col-account">
									<input type="text" class="form-control rounded-0 readonly" value="${stu.account}" disabled readonly>
								</td>
							</tr>
						`;
					});

					tableHTML += `
						<div class="table-responsive">
							<table class="table table-bordered mb-0 table-studentSet" id="${tableId}">
								<thead>
									<tr>
										<th scope="col" class="col-classCheck">
											<div class="form-check form-check-inline form-check-red">
												<input class="form-check-input" type="checkbox" id="${checkAllId}" name="checkAll">
											</div>
											<button class="btn btn-link p-0"
												type="button"
												data-bs-toggle="collapse"
												data-bs-target="#${bodyId}"
												aria-expanded="true"
												aria-controls="${bodyId}">
												${cls.class}
											</button>
										</th>
										<th class="col-studentName">姓名</th>
										<th class="col-studentId">學號</th>
										<th class="col-account">帳號/信箱</th>
									</tr>
								</thead>
								<tbody class="collapse show" id="${bodyId}">
									${studentRows}
								</tbody>
							</table>
						</div>
					`;
				});

				// ===== 年級 accordion =====
				accordionHTML += `
					<div class="accordion-item">
						<h4 class="accordion-header">
							<button class="accordion-button ${collapsed}"
								type="button"
								data-bs-toggle="collapse"
								data-bs-target="#${gradeId}"
								aria-expanded="${gIdx === 0}"
								aria-controls="${gradeId}">
								${grade}年級
							</button>
						</h4>

						<div id="${gradeId}" class="accordion-collapse collapse ${showGrade}" data-bs-parent="#accordionStudentSet">
							<div class="accordion-body p-0">
								${tableHTML}
							</div>
						</div>
					</div>
				`;
			});

			$('#accordionStudentSet').html(accordionHTML);
			
			checkboxFun();
		});
	}

	//[設定學生]checkbox 
  function checkboxFun() {
		// 全選（每張班級 table 各自處理）
		$('.table-studentSet').on('change', 'input[name="checkAll"]', function () {
			const $table = $(this).closest('.table-studentSet');
			const checkAll = this;
			const $checks = $table.find('input[name="check"]:checkbox');

			if (checkAll.checked) {
			$checks.prop('checked', true);
			checkAll.indeterminate = false;
			} else {
			$checks.prop('checked', false);
			checkAll.indeterminate = false;
			}
		});
		// 單筆勾選 → 控制全選狀態（含 indeterminate）
		$('.table-studentSet').on('change', 'input[name="check"]', function () {
			const $table = $(this).closest('.table-studentSet');
			const checkAll = $table.find('input[name="checkAll"]')[0];
			const total = $table.find('input[name="check"]:checkbox').length;
			const checked = $table.find('input[name="check"]:checked').length;

			if (!checkAll) return;

			if (checked === 0) {
				checkAll.checked = false;
				checkAll.indeterminate = false;
			} else if (checked === total) {
				checkAll.checked = true;
				checkAll.indeterminate = false;
			} else {
				checkAll.checked = false;
				checkAll.indeterminate = true;
			}
		});
	}
  /////////////////////////////////////////////////

  //[學生名單]datatables 
  $('#sessionStudentList').DataTable({
    //serverSide: true,
    order: [], //取消默認排序icon
    ordering: false,
    autoWidth: false,
    responsive: false,
    searching: true,
    pageLength: 10,
    pagingType: "simple_numbers",
    dom: '<"table-responsive"rt>'
      + '<"datatables-custom-footer clearfix"pi>',
    language: {
      url: 'Content/widgets/DataTables/lang/Chinese-traditional.json'
    },
    //ajax: 'Content/json/DACC-session/sessionStudentList.json',
    columnDefs: [{ //序號
        targets: 0,
        title: '序號',
        width: '8%',
        className: 'col-index',
        type: 'numeric',
        render: function (data, type, row, meta) {
          return meta.row + 1;
        }
      },
      { //年級
        targets: 1,
        title: '年級',
        data: 'grade',
        width: '10%',
        className: 'col-grade',
        type: 'numeric',
      },
      { //班級
        targets: 2,
        title: '班級',
        data: 'class',
        width: '12%',
        className: 'col-class',
        type: 'string',
        render: function (data, type, row, meta) {
          return `<input type="text" class="form-control rounded-0 readonly" value="` + data + `" disabled readonly>`;
        }
      },
      { //姓名 
        targets: 3,
        title: '姓名',
        data: 'studentName',
        width: '13%',
        className: 'col-studentName',
        type: 'string',
        render: function (data, type, row, meta) {
          return `<input type="text" class="form-control rounded-0 readonly" value="` + data + `" disabled readonly>`;
        }
      },
      { //學號
        targets: 4,
        title: '學號',
        data: 'studentId',
        width: '13%',
        className: 'col-studentId',
        type: 'string',
        render: function (data, type, row, meta) {
          return `<input type="text" class="form-control rounded-0 readonly" value="` + data + `" disabled readonly>`;
        }
      },
      { //帳號/信箱
        targets: 5,
        title: '帳號/信箱',
        data: 'account',
        width: '34%',
        className: 'col-account',
        type: 'string',
        render: function (data, type, row, meta) {
          return `<input type="text" class="form-control rounded-0 readonly" value="` + data + `" disabled readonly>`;
        }
      },
      { //狀態
        targets: 6,
        title: '狀態',
        data: 'status',
        width: '10%',
        className: 'col-status',
        type: 'html',
        orderDataType: 'dom-text',
        render: function (data, type, row, meta) {
          let status;
          switch (data) {
            case 0:
              status = `<span class="text-red">未完成</span>`;
              break
            case 1:
              status = `<span>完成</span>`;
              break
            default:
              status = '';
              break
          }
          return status;
        }
      }

    ],
    initComplete: function () {
      //datatable footer input page
      datatableInputPage($('#sessionStudentList'));
    }
  });
  //[學生名單]
  $table.on('click', '.btn-session-studentLists', function () {
    $('#studentListsModal').modal('show');

    //do something... (取得sessionLists行列項目資料)

    $('#studentListsModal').on('shown.bs.modal', function () {
      $('#sessionStudentList').DataTable().ajax.url('Content/json/DACC-session/sessionStudentList.json').load();
    });
  });
  //[學生名單] > [搜尋]
  $('#btnSearch_studentLists').click(function () {
    $('#sessionStudentList').DataTable().search($('#searchKeywords_studentLists').val()).draw();
  });
  //[學生名單] > [搜尋][X]重置
  $('#searchKeywords_studentLists + .btn-close').click(function () {
    $('#sessionStudentList').DataTable().search('').draw();
  });
  //[學生名單] - checkbox只能擇一 - 搜尋
  $('input[name="showList"]').click(function () {
    if ($(this).prop('checked')) {
      $('.SRform-check input:checkbox').prop('checked', false);
      $(this).prop('checked', true);

      //$('#sessionStudentList').DataTable().column('.col-status').search('<span class="text-red">未完成</span>', true, true).draw();
    }
  });

  /////////////////////////////////////////////////

  //[場次設定]
  $table.on('click', '.btn-session-sessionSet', function () {
    $('#sessionSetModal').modal('show');

    //do something... 取得表格值
  });
  //[場次設定] > [儲存設定]
  $('#updateSession').click(function () {
    let updateOk = true; //[true | false] [成功 | 失敗]

    //demo驗證
    let errorText = '';
    let validationField = '#updateSessionName, #updateStartDatetime, #updateEndDatetime';

    //demo偵測欄位是否為空值
    $(validationField).each(function () {
      if ($(this).val().trim() == '') {
        $(this).addClass('empty invalid');
      } else {
        $(this).removeClass('empty invalid');
      }
    });

    //demo錯誤訊息內容
    if ($(validationField).hasClass('empty')) {
      errorText += '*號為必填欄位<br>';
    }

    //demo是否有錯誤訊息、驗證是否成功
    if (errorText != '') {
      insertOk = false;
    } else {
      insertOk = true;
    }

    if (insertOk == true) { //新增成功
      $('#updateSessionMsg').html('');
      $('#sessionSetModal').find('input, select').removeClass('empty invalid');

      alertModal('<div class="text-red">儲存成功！</div>');

      $('#alertModal').on('hidden.bs.modal', function () {
        //關閉modal
        $('#sessionSetModal').modal('hide');
      });
    } else { //新增失敗
      $('#updateSessionMsg').html(errorText);
    }
  });
});

</script>
</body>
</html>
