<!doctype html>
<html lang="zh-hant-TW">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="SmartReading 適性閱讀 教師端">
<meta name="author" content="SmartReading">
<meta name="generator" content="SmartReading">
<title>SmartReading 教師端</title>
<link rel="shortcut icon" type="image/x-icon" href="Content/images/favicon.ico">
<!-- google fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,100..900;1,100..900&family=Noto+Sans+TC:wght@100..900&display=swap" rel="stylesheet">

<!-- widgets CSS -->
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">
<link rel="stylesheet" type="text/css" href="Content/widgets/DataTables/datatables.min.css">
<!--<link rel="stylesheet" type="text/css" href="Content/widgets/DataTables/buttons-2.4.2/css/buttons.dataTables.min.css">	--> 

<!-- template CSS -->
<link rel="stylesheet" type="text/css" href="Content/css/bootstrap.css">
<link rel="stylesheet" type="text/css" href="Content/css/SRv3-manager.css">
</head>
<body>
<form>
  <header> </header>
  <div class="container-fluid">
    <div class="row">
      <nav id="sidebarMenu" class="col-xl-2 d-xl-block bg-white sidebar collapse"> </nav>
      <main class="col-xl-10"> 
        <!-- ------- ------- ------- ------- ------- ------- ------- -->
        <h2>教學書單管理</h2>
        <!-- 教學指定書單/班級學生書單-頁籤 start -->
        <div class="row">
          <ul class="nav nav-viewinfo-school">
            <li class="nav-item"> <a class="nav-link active" href="RP-bookList-teaching.html">教學指定書單</a> </li>
            <li class="nav-item"> <a class="nav-link" aria-current="page" href="RP-bookList-class.html">班級學生書單</a> </li>
          </ul>
        </div>
        <!-- 教學指定書單/班級學生書單-頁籤 end  --> 
        
        <!-- 教學指定書單 start -->
        <div class="row py-3 py-xl-5 px-1 px-xl-4"> 
          <!-- 按鈕 start -->
          <div class="col-xxl-5 mb-3" id="blockBtns">
            <button type="button" class="btn btn-primary my-1" id="setting"><i class="fa-solid fa-gear me-1"></i>書單設定</button>
            <button type="button" class="btn btn-outline-primary bg-gradient my-1" id="insert"><i class="fa-solid fa-plus me-1"></i>新增書單</button>
          </div>
          <!-- 按鈕  end  --> 
          <!-- 搜尋 start -->
          <div class="col-xxl-7 mb-3" id="blockSearch">
            <div class="row g-2 align-items-center justify-content-end">
              <div class="col-auto">
                <label for="searchStatus" class="col-form-label fs-7">狀態</label>
              </div>
              <div class="col-auto">
                <select class="form-select rounded-0 form-select-sm form-select-arrow-sm" id="searchStatus">
                  <option value="" selected>全部</option>
                  <option value="1">ON</option>
                  <option value="0">OFF</option>
                </select>
              </div>
              <div class="col-auto d-none d-lg-inline ms-3">
                <label for="searchKeywords" class="col-form-label fs-7">搜尋</label>
              </div>
              <div class="col-auto">
                <div class="input-group">
                  <div class="input-group-clear">
                    <input type="text" class="form-control rounded-0" placeholder="請輸入關鍵字..." aria-label="請輸入關鍵字..." aria-describedby="btnSearch" id="searchKeywords">
                    <button class="btn btn-close" type="button"></button>
                  </div>
                  <button class="btn btn-gray-100 rounded-0 border-gray-400 text-primary lh-1" type="button" id="btnSearch"><i class="fa-solid fa-magnifying-glass fs-5 mx-n1"></i></button>
                </div>
              </div>
            </div>
          </div>
          <!-- 搜尋  end  --> 
          <!-- 表格 start -->
          <div class="col-xl-12 mb-5">
            <table class="table table-bordered table-teaching-overview" id="teachingOverviewTable">
              <thead>
                <tr>
                  <th scope="col" class="row-delete">刪除</th>
                  <th scope="col" class="row-index">序號</th>
                  <th scope="col" class="row-bookList">已建置書單</th>
                  <th scope="col" class="row-year">建立年度</th>
                  <th scope="col" class="row-bookCount">當前書籍數</th>
                  <th scope="col" class="row-classCount">使用班級數</th>
                  <th scope="col" class="row-assignClass">指派班級</th>
                  <th scope="col" class="row-editList">編輯書單</th>
                  <th scope="col" class="row-status">狀態</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="row-delete"><div class="SRform-check-red">
                      <input class="form-check-input" type="checkbox" name="delete">
                    </div></td>
                  <td class="row-index">1</td>
                  <td class="row-bookList"><input type="text" class="form-control rounded-0 readonly" value="香蕉小組書單1" disabled></td>
                  <td class="row-year">2022</td>
                  <td class="row-bookCount">20</td>
                  <td class="row-classCount">3</td>
                  <td class="row-assignClass"><button type="button" class="btn btn-outline-primary bg-gradient w-100">指派</button></td>
                  <td class="row-editList"><button type="button" class="btn btn-outline-primary bg-gradient w-100">編輯</button></td>
                  <td class="row-status"><div class="form-check form-switch form-check-inline m-0">
                      <input class="form-check-input" type="checkbox" role="switch">
                    </div></td>
                </tr>
              </tbody>
            </table>
          </div>
          <!-- 表格  end  --> 
          <!-- [書單設定]-按鈕 start -->
          <div class="col-xl-12 text-center mb-5" id="blockSettingBtns" style="display: none;">
            <div>
              <button type="button" class="btn btn-outline-primary m-1" id="settingCancel">取消</button>
              <button type="button" class="btn btn-primary m-1" id="settingConfirm">確定設定</button>
            </div>
          </div>
          <!-- [書單設定]-按鈕  end  --> 
        </div>
        <!-- 教學指定書單  end  --> 
        <!-- ------- ------- ------- ------- ------- ------- ------- --> 
      </main>
    </div>
  </div>
  
  <!-- Modal#bookListModal 新增/編輯書單 start -->
  <div class="modal fade" id="bookListModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="bookListModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered">
      <div class="modal-content rounded-0">
        <div class="modal-header">
          <button type="button" class="btn-close float-start" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="row px-xl-5 justify-content-center"> 
            <!-- 新增/編輯書單 start -->
            <div class="mb-3 row">
              <h3 class="text-center h6">新增/編輯書單</h3>
            </div>
            <!-- 欄位 start -->
            <div class="SRform col-xl-12">
              <div class="mb-3 row align-items-center d-lg-flex">
                <label for="BookListName" class="col-lg-auto col-form-label">書單名稱<span class="text-red">*</span></label>
                <div class="col-lg-auto">
                  <input type="text" class="form-control rounded-0 bg-primary bg-opacity-10" id="BookListName">
                </div>
                <div class="col-lg-auto px-lg-0 text-end"> <span class="form-text">必填，最多12字</span> </div>
              </div>
              <div class="mb-3 row align-items-center d-lg-flex">
                <label for="bookListContent" class="col-lg-auto col-form-label">內容說明</label>
                <div class="col-lg-auto flex-lg-grow-1">
                  <textarea class="form-control rounded-0 bg-primary bg-opacity-10" id="bookListContent" rows="4"></textarea>
                </div>
                <div class="text-end"> <span class="form-text">選填，最多100字</span> </div>
              </div>
            </div>
            <!-- 欄位  end  --> 
            <!-- 搜尋 start -->
            <div class="col-xl-12 mb-3">
              <div class="row g-2 align-items-center">
                <div class="col-auto me-auto">
                  <button type="button" class="btn btn-outline-primary bg-gradient my-1" id="adjustBook"><i class="fa-solid fa-plus me-1"></i>增/減書籍</button>
                </div>
                <div class="col-auto ms-auto">
                  <div class="row g-2">
                    <div class="col-auto d-none d-lg-inline ms-3">
                      <label for="searchKeywords_adjustBook" class="col-form-label fs-7">搜尋</label>
                    </div>
                    <div class="col-auto">
                      <div class="input-group">
                        <div class="input-group-clear">
                          <input type="text" class="form-control rounded-0" placeholder="請輸入關鍵字..." aria-label="請輸入關鍵字..." aria-describedby="btnSearch_adjustBook" id="searchKeywords_adjustBook">
                          <button class="btn btn-close" type="button"></button>
                        </div>
                        <button class="btn btn-gray-100 rounded-0 border-gray-400 text-primary lh-1" type="button" id="btnSearch_adjustBook"><i class="fa-solid fa-magnifying-glass fs-5 mx-n1"></i></button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- 搜尋  end  --> 
            <!-- 表格 start -->
            <div class="col-xl-12">
              <div class="table-responsive">
                <table class="table table-bordered table-teaching-detial" id="teachingDetialTable">
                  <thead>
                    <tr>
                      <th scope="col" class="row-index">序號</th>
                      <th scope="col" class="row-bookTitle">書名</th>
                      <th scope="col" class="row-author">作者</th>
                      <th scope="col" class="row-publisher">出版社</th>
                      <th scope="col" class="row-publicationYear">出版年</th>
                      <th scope="col" class="row-SR">難度</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td class="row-index">1</td>
                      <td class="row-bookTitle">戀愛動物圖鑑</td>
                      <td class="row-author">蔣詩綺</td>
                      <td class="row-publisher">漢宇國際</td>
                      <td class="row-publicationYear">2012</td>
                      <td class="row-SR">SR 513</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <!-- 表格  end  --> 
            <!-- 按鈕 start -->
            <div class="col-xl-12 text-center my-4">
              <button type="button" class="btn btn-outline-primary m-1" id="bookListCancel" data-bs-dismiss="modal">取消</button>
              <button type="button" class="btn btn-primary m-1" id="bookListConfirm">確定新增/編輯</button>
            </div>
            <!-- 按鈕  end  --> 
            <!-- 新增書單  end  --> 
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Modal#bookListModal 新增書單  end  --> 
  
  <!-- Modal#adjustBookModal 增/減書籍 start -->
  <div class="modal fade" id="adjustBookModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="adjustBookModal" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered">
      <div class="modal-content rounded-0">
        <div class="modal-header">
          <button type="button" class="btn-close float-start" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="bg-primary bg-opacity-10 border border-2 border-dashed mx-3 px-3">
            <div class="py-2 small"> <a href="" role="button"  data-bs-dismiss="modal"><i class="fa-solid fa-chevron-left me-1"></i>返回查看書單</a> </div>
            <div class="mb-3 row">
              <h3 class="text-center h6">增/減書籍</h3>
            </div>
            <!-- 搜尋 start -->
            <div class="row mb-3 justify-content-center">
              <label for="inputSearchBook" class="col-sm-auto col-form-label">搜索書籍</label>
              <div class="col-sm-6">
                <div class="input-group">
                  <div class="input-group-clear">
                    <input type="text" class="form-control rounded-0" placeholder="請輸入關鍵字..." aria-label="請輸入關鍵字..." aria-describedby="btnSearch" >
                    <button class="btn btn-close" type="button"></button>
                  </div>
                  <button class="btn btn-gray-100 rounded-0 border-gray-400 text-primary lh-1" type="button" id=""><i class="fa-solid fa-magnifying-glass fs-5 mx-n1"></i></button>
                </div>
              </div>
            </div>
            <div class="row mb-3 gy-1 align-items-center justify-content-center">
              <label for="btncheck1" class="col-xl-auto control-label small">適讀年級</label>
              <div class="col-xl-auto">
                <div class="d-grid gap-1 adjustBook-checkbox-grid">
                  <input type="checkbox" class="btn-check" id="btncheck1" autocomplete="off">
                  <label class="btn btn-outline-secondary btn-sm bg-white rounded-0" for="btncheck1">一年級以下</label>
                  <input type="checkbox" class="btn-check" id="btncheck2" autocomplete="off">
                  <label class="btn btn-outline-secondary btn-sm bg-white rounded-0" for="btncheck2">二年級</label>
                  <input type="checkbox" class="btn-check" id="btncheck3" autocomplete="off">
                  <label class="btn btn-outline-secondary btn-sm bg-white rounded-0" for="btncheck3">三年級</label>
                  <input type="checkbox" class="btn-check" id="btncheck4" autocomplete="off">
                  <label class="btn btn-outline-secondary btn-sm bg-white rounded-0" for="btncheck4">四年級</label>
                  <input type="checkbox" class="btn-check" id="btncheck5" autocomplete="off">
                  <label class="btn btn-outline-secondary btn-sm bg-white rounded-0" for="btncheck5">五年級</label>
                  <input type="checkbox" class="btn-check" id="btncheck6" autocomplete="off">
                  <label class="btn btn-outline-secondary btn-sm bg-white rounded-0" for="btncheck6">六年級</label>
                  <input type="checkbox" class="btn-check" id="btncheck7" autocomplete="off">
                  <label class="btn btn-outline-secondary btn-sm bg-white rounded-0" for="btncheck7">七年級</label>
                  <input type="checkbox" class="btn-check" id="btncheck8" autocomplete="off">
                  <label class="btn btn-outline-secondary btn-sm bg-white rounded-0" for="btncheck8">八年級</label>
                  <input type="checkbox" class="btn-check" id="btncheck9" autocomplete="off">
                  <label class="btn btn-outline-secondary btn-sm bg-white rounded-0" for="btncheck9">九年級</label>
                  <input type="checkbox" class="btn-check" id="btncheck10" autocomplete="off">
                  <label class="btn btn-outline-secondary btn-sm bg-white rounded-0" for="btncheck10">十年級</label>
                  <input type="checkbox" class="btn-check" id="btncheck11" autocomplete="off">
                  <label class="btn btn-outline-secondary btn-sm bg-white rounded-0" for="btncheck11">十一年級</label>
                  <input type="checkbox" class="btn-check" id="btncheck12" autocomplete="off">
                  <label class="btn btn-outline-secondary btn-sm bg-white rounded-0" for="btncheck12">十二年級以上</label>
                </div>
              </div>
              <div class="col-xl-auto">
                <div class="d-md-grid gap-1 d-md-block text-center">
                  <button type="button" class="btn btn-primary" id="">全選</button>
                  <button type="reset" class="btn btn-outline-primary">取消</button>
                </div>
              </div>
            </div>
            <div class="row mt-5 mb-4">
              <label for="SRrangeBar-s-control" class="col-xl-auto control-label small">推薦難度範圍</label>
              <div class="col-xl-auto flex-grow-1">
                <div class="SRrangeBar">
                  <div id="SRrangeBar-s-range" class="SRrangeBar-slider s-range"> </div>
                  <div id="SRrangeBar-s-control" class="SRrangeBar-slider s-control" data-popup-enabled="true"> </div>
                </div>
              </div>
            </div>
            <!-- 搜尋 end  --> 
            <!-- 搜尋結果 start -->
            <div class="bg-body mx-n3"> 
              <!-- recommendedBook-list start -->
              <div class="recommendedBook-list">
                <div class="container">
                  <table class="table table-borderless table-recommendedBook" id="recommendedBook">
                    <thead>
                      <tr>
                        <th class="row-id">ID</th>
                        <th class="row-good">優選書單</th>
                        <th class="row-cover">書封面</th>
                        <th class="row-bookTitle">書名</th>
                        <th class="row-SR">圖書難度</th>
                        <th class="row-category">分類</th>
                        <th class="row-topicType">題本類別</th>
                        <th class="row-ebook">電子書</th>
                        <th class="row-checkbox">加入書單</th>
                        <th class="row-bookplanet">布可星球</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td class="row-id">052c8e4a-e0e4-4074-85b1-848f9f3b4313</td>
                        <td class="row-good"><img src="Content/images/recommendedBook/goodBook.png" width="66" height="65" alt=""></td>
                        <td class="row-cover"><a role="button" class="hover-effect-dark" data-toggle="modal" data-target="#modal-bookIntro"><img src="https://smartreading.net/RP/BookContent/BookFront/16080.jpg"></a></td>
                        <td class="row-bookTitle">能量七密碼：療癒身心靈，喚醒你本有的創造力、直覺和內在力量【附24張圖例】（The Energy Codes： The 7-Step System to Awaken Your Spirit，Heal Your Body，and Live Your Best Life）</td>
                        <td class="row-SR" data-th="圖書難度">SR 999</td>
                        <td class="row-category" data-th="分類">成長/生命教育成長/生命教</td>
                        <td class="row-topicType" data-th="題本類別">摘要題成長/生命教</td>
                        <td class="row-ebook"><img src="Content/images/recommendedBook/icon-ebook-gray.png" width="18" height="18"  alt="">&nbsp;電子書</td>
                        <td class="row-checkbox"><div class="form-check form-check-inline">
                            <input class="form-check-input border-primary" type="checkbox" value="" id="checkbox8">
                            <label class="form-check-label visually-hidden" for="checkbox8">加入書單</label>
                          </div></td>
                        <td class="row-bookplanet"><img src="Content/images/recommendedBook/borrowLink/bookplanet.png" alt="布可星球"></td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
              <!-- recommendedBook-list end --> 
            </div>
            <!-- 搜尋結果 end  --> 
            <!-- 按鈕 start -->
            <div class="text-center py-3">
              <button type="button" class="btn btn-outline-primary m-1" id="ndecreaseCancel" data-bs-dismiss="modal">取消</button>
              <button type="button" class="btn btn-primary m-1" id="ndecreaseOk">確定設定</button>
            </div>
            <!-- 按鈕 end  --> 
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Modal#indecreaseModal 增/減書籍  end  --> 
  
  <!-- Modal#assignModal 指派班級 start -->
  <div class="modal fade" id="assignModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="assignModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content rounded-0">
        <div class="modal-header">
          <button type="button" class="btn-close float-start" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="row px-2 justify-content-center"> 
            <!-- 指派班級 start -->
            <div class="mb-3 row">
              <h3 class="text-center h6">指派班級<small class="text-red">(待修樹狀選單JS)</small></h3>
            </div>
            <!-- (沒有)手風琴 start -->
            <div class="col-xl-12 mb-5">
              <div class="accordion SRaccordion accordion-StudentSet" id="accordionStudentSet"> 
                <!-- *年級 start -->
                <div class="accordion-item">
                  <h4 class="accordion-header">
                    <button class="accordion-button collapsed bg-white" type="button">
                    <span class="form-check-inline SRform-check-red me-2">
                    <input class="form-check-input my-0" type="checkbox" name="checkAll">
                    </span>4年級
                    </button>
                  </h4>
                  <div id="collapse4" class="accordion-collapse ">
                    <div class="accordion-body p-0"> 
                      <!-- 表格 start -->
                      <table class="table table-bordered mb-0 table-studentSet" id="studentSet4-1">
                        <tbody class="" id="studentSet4-1-tbody">
                          <tr>
                            <td class=""><div class="SRform-check-red">
                                <input class="form-check-input" type="checkbox" name="check">
                                1班 </div></td>
                            <td class=""><div class="SRform-check-red">
                                <input class="form-check-input" type="checkbox" name="check">
                                1班 </div></td>
                            <td class=""><div class="SRform-check-red">
                                <input class="form-check-input" type="checkbox" name="check">
                                1班 </div></td>
                            <td class=""><div class="SRform-check-red">
                                <input class="form-check-input" type="checkbox" name="check">
                                1班 </div></td>
                            <td class=""><div class="SRform-check-red">
                                <input class="form-check-input" type="checkbox" name="check">
                                1班 </div></td>
                          </tr>
                        </tbody>
                      </table>
                      <!-- 表格  end  --> 
                    </div>
                  </div>
                </div>
                <!-- *年級  end  --> 
              </div>
            </div>
            <!-- (沒有)手風琴  end  -->
            <div class="mb-3 row align-items-center">
              <div class="col text-center">
                <button type="button" class="btn btn-outline-primary m-1" data-bs-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary m-1" id="insertSession">確定指派</button>
              </div>
            </div>
            <!-- 指派班級  end  --> 
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Modal#assignModal 指派班級  end  -->
  
  <footer> </footer>
</form>
<!-- ------- ------- ------- ------- ------- ------- ------- --> 
<!-- ------- ------- ------- ------- ------- ------- ------- --> 
<!-- ------- ------- ------- ------- ------- ------- ------- --> 
<script src="Content/js/jquery-3.6.0.min.js"></script> 
<!-- widgets JS --> 
<script src="Content/js/bootstrap.bundle.min.js"></script> 	
<script src="Content/js/doubleScorollbar.js"></script> 	
<script src="Content/widgets/DataTables/datatables.min.js"></script> 
<script src="Content/widgets/DataTables/buttons-2.4.2/js/dataTables.buttons.min.js"></script> 
<script src="Content/widgets/DataTables/buttons-2.4.2/js/buttons.html5.min.js"></script> 
<script src="Content/widgets/DataTables/buttons-2.4.2/js/buttons.print.min.js"></script> 
	
<!-- my JS --> 
<script src="Content/js/main.js"></script> 
<script>
$(document).ready(function() {
    //call header、footer、 sidebar  
    $('header').load('master_header.html', function(){
        //當前頁名稱顯示
        $('#currentPage').text( $('main h2').text() ).addClass('active'); 
    });  
    $('footer').load('master_footer.html'); 
    $('#sidebarMenu').load('master_sidebar.html', function(){
        //當前頁actvie
        $('#sidebarMenu .nav-link[href*="RP-bookList"]').addClass('active');  
    }); 
    
    const list = $('#teachingOverviewTable');
    //教學指定書單 datatables 
	list.DataTable({
        //serverSide: true,
        order: [],  //取消默認排序icon
        autoWidth: false,
        responsive: false,
		searching: true,
		pageLength: 10,
		pagingType: "simple_numbers",
        dom: '<"table-responsive"rt>'+
			 '<"datatables-custom-footer clearfix"pi>',
        language: {
          url: 'Content/widgets/DataTables/lang/Chinese-traditional.json'
        },
        ajax: 'Content/json/RP-bookList/teaching-overview.json',
        columnDefs: [
            {//刪除
                targets: 0, 
                title: '刪除',
                className: 'row-delete',
                orderable: false,
                visible: false,
                render: function (data, type, row, meta) {
                    return `<div class="SRform-check-red">
                              <input class="form-check-input" type="checkbox" name="delete">
                            </div>`; 
                } 
            },
            {//序號
                targets: 1, 
                title: '序號',
                className: 'row-index',
                orderable: false,
                render: function (data, type, row, meta) {
                    return meta.row + 1; 
                } 
            },
            {//已建置書單
                targets: 2, 
                title: '已建置書單',
                data: 'bookList',
                className: 'row-bookList',
                orderable: false, 
                render: function (data, type, row, meta) {
                    return `<input type="text" class="form-control rounded-0 readonly" value="` + data + `" disabled>`;
                } 
            },
            {//建立年度 
                targets: 3,
                title: '建立年度',
                data: 'year',
                className: 'row-year',
                orderable: false,
            },
            {//當前書籍數
                targets: 4, 
                title: '當前書籍數',
                data: 'bookCount',
                className: 'row-bookCount',
                orderable: false,
            },
            {//使用班級數
                targets: 5, 
                title: '使用班級數',
                data: 'classCount',
                className: 'row-classCount',
                orderable: false,
            },
            {//指派班級
                targets: 6, 
                title: '指派班級',
                data: 'assignClass',
                className: 'row-assignClass',
                orderable: false,
                render: function (data, type, row, meta) {
                    return `<button type="button" class="btn btn-outline-primary bg-gradient w-100">指派</button>`;
                }
            },
            {//編輯書單
                targets: 7, 
                title: '編輯書單',
                data: 'editList',
                className: 'row-editList',
                orderable: false,
                render: function (data, type, row, meta) {
                    return `<button type="button" class="btn btn-outline-primary bg-gradient w-100">編輯</button>`;
                }
            },
            {//狀態
                targets: 8, 
                title: '狀態',
                data: 'status',
                className: 'row-status',
                orderable: false,
                render: function (data, type, row, meta) {
                    let status;
                    switch (data) {
						case 0:
                            status = `<div class="form-check form-switch form-check-inline m-0">
                                        <input class="form-check-input readonly" type="checkbox" role="switch" disabled>
                                      </div>`;
                            break 	
                        case 1:
                            status = `<div class="form-check form-switch form-check-inline m-0">
                                        <input class="form-check-input readonly" type="checkbox" role="switch" checked disabled>
                                      </div>`;
                            break
                        default:
                            status = '';
                            break 
                    }
                    return status;
                } 
            }
            
        ],
        initComplete: function() {
            //datatable footer input page
            datatableInputPage(list);
        }
    });
    
    //[書單設定]
    $('#setting').click(function(){
        //功能按鈕區、搜尋區 不可按
        $('#blockBtns, #blockSearch').find('button, input, select').attr('disabled', true);
		
		//頁碼隱藏(僅可編輯目前畫面的資料)
        $('.datatables-custom-footer').hide(); 

        //[書單設定]-按鈕 顯示
        $('#blockSettingBtns').show(); 
		
		//表格欄位 可編輯
        list.find('input, select').attr('disabled', false).removeClass('readonly'); 
		
		//表格欄位 顯示刪除、隱藏序號
        list.DataTable().column('.row-delete').visible(true); 
        list.DataTable().column('.row-index').visible(false); 
		
		//表格按鈕 不可按
        if (list.find('button').length) {
		  list.find('button').attr('disabled', true);
		}
    });
    
    //[書單設定]>[取消]
    $('#settingCancel').click(function(){
        //do something... (若有修改資料，按取消需還原為原資料)
        
        //功能按鈕區、搜尋區 可按
        $('#blockBtns, #blockSearch').find('button, input, select').attr('disabled', false);
		
		//頁碼顯示
        $('.datatables-custom-footer').show(); 
		
		//[書單設定]-按鈕 隱藏
        $('#blockSettingBtns').hide(); 
		
		//表格欄位 不可編輯
        list.find('td:not(.row-delete)').find('input, select').attr('disabled', true).addClass('readonly');
        
        //表格欄位 隱藏刪除、顯示序號
        list.DataTable().column('.row-delete').visible(false); 
        list.DataTable().column('.row-index').visible(true); 
        
        //表格按鈕 可按
		if (list.find('button').length) {
		  list.find('button').attr('disabled', false);
		}

		//若有錯誤紅框，則清除紅框
		if (list.find('.invalid').length) {
		  list.find('.invalid').removeClass('invalid');
		}
    });
    
    //[書單設定]>[確定修改]
    $('#settingConfirm').click(function(){
		//do something... (修改)
        let editOk = true; //[true | false] [修改成功 | 修改失敗]
        
        if(editOk == true){//修改成功
            let selectedCheckboxes = $('input[type="checkbox"][name="delete"]:checked');
            let selectedCount = selectedCheckboxes.length;
            let selectedClass = selectedCheckboxes.map(function() {
                const tr = $(this).closest('tr');
                const Class = tr.find('td.row-bookList input').val();
                return Class;
            }).get();
        
            if( selectedCount > 0){ //有刪除則跳出確認視窗
                confirmModal('是否確定要刪除書單：<b class="text-red">' + selectedClass.join('、') +'</b>？');
                
                $('#confirmOk').click(function(){
                    //do something... (修改)
                    
                    editOkAlert();    
                });
            }else{
                //do something... (修改)
                
                editOkAlert();
            }
            
            function editOkAlert(){
                alertModal('<div class="text-red">修改成功！</div>');
            
                $('#alertModal').on('hidden.bs.modal', function () {
                    //功能按鈕區、搜尋區 可按
                    $('#blockBtns, #blockSearch').find('button, input, select').attr('disabled', false);
					
					//頁碼顯示
                    $('.datatables-custom-footer').show(); 
					
					//[書單設定]-按鈕 隱藏
                    $('#blockSettingBtns').hide();
					
					//表格欄位 不可編輯
                    list.find('input, select').attr('disabled', true).addClass('readonly');

                    //表格欄位 隱藏刪除、顯示序號
                    list.DataTable().column('.row-delete').visible(false); 
                    list.DataTable().column('.row-index').visible(true); 

                    //表格按鈕 可按
                    if (list.find('button').length) {
					  list.find('button').attr('disabled', false);
					}

                    //若有錯誤紅框，則清除紅框
					if (list.find('.invalid').length) {
					  list.find('.invalid').removeClass('invalid');
					}    
                });    
            }
        }else{//修改失敗 demo
			alertModal('<div class="text-red">書單名稱不可空白</div>', function () {
    			const invalidInputs = list.find(`tbody tr:nth-child(1) .row-bookList input,
												 tbody tr:nth-child(3) .row-bookList input`).addClass('invalid');

				// 如有錯誤欄位 → 捲動至第一個
				if (invalidInputs.length > 0) {
					const firstInvalid = invalidInputs.first();

					$('html, body').animate({
						scrollTop: firstInvalid.offset().top - 120  
					}, 500);
				}
			});
        }
    });
    
    //[新增書單]
    $('#insert').click(function(){ 
		 $('#bookListModal').attr('data-modal-type', 'insert').modal('show');
		
		$('#bookListModal h3').text('新增書單');
		$('#bookListConfirm').text('確定新增');

        loadteachingDetialTable(null);
    });
    
    //表格-編輯書單 > [編輯]
    list.on('click', '.row-editList button', function (){ 
		$('#bookListModal').attr('data-modal-type', 'edit').modal('show'); 
		
		$('#bookListModal h3').text('編輯書單');
		$('#bookListConfirm').text('確定');
		
        loadteachingDetialTable('Content/json/RP-bookList/teaching-detial.json');
    });
		
	//[增/減書籍]
    $('#adjustBook').click(function(){
        $('#adjustBookModal').modal('show');
		
		loadRecommendedBook();
    });
    
    //表格-指派班級 > [指派]
    list.on('click', '.row-assignClass button', function (){
        $('#assignModal').modal('show');    
    });
}); 
</script> 

<!-- 新增/編輯書單 --> 
<script>
function loadteachingDetialTable(json) { 
	const list2 = $('#teachingDetialTable');
	
	if ($.fn.DataTable.isDataTable(list2)) { 
        list2.DataTable().clear().destroy();
        list2.find('tbody').empty();
    }

	list2.DataTable({
        //serverSide: true,
        order: [],  //取消默認排序icon
        autoWidth: false,
        responsive: false,
		searching: true,
		pageLength: 10,
		pagingType: "simple_numbers",
        dom: '<"table-responsive"rt>'+
			 '<"datatables-custom-footer clearfix"pi>',
        language: {
          	url: 'Content/widgets/DataTables/lang/Chinese-traditional.json'
        },
        ajax: function(data, callback, settings) {
			if (json) {
                $.getJSON(json, function(res){
                    callback(res);
                });
            } else {
                callback({ data: [] });
            }
		},
        columnDefs: [
            {//序號
                targets: 0, 
                title: '序號',
                className: 'row-index',
                orderable: false,
                render: function (data, type, row, meta) {
                    return meta.row + 1; 
                } 
            },
            {//書名
                targets: 1, 
                title: '書名',
                data: 'bookTitle',
                className: 'row-bookTitle',
                orderable: false, 
            },
            {//作者 
                targets: 2,
                title: '作者',
                data: 'author',
                className: 'row-author',
                orderable: false,
            },
            {//出版社
                targets: 3, 
                title: '出版社',
                data: 'publisher',
                className: 'row-publisher',
                orderable: false,
            },
            {//出版年
                targets: 4, 
                title: '出版年',
                data: 'publicationYear',
                className: 'row-publicationYear',
                orderable: false,
            },
            {//難度
                targets: 5, 
                title: '難度',
                data: 'SR',
                className: 'row-SR',
                orderable: false,
            }
        ],
        initComplete: function() {
            //datatable footer input page
            datatableInputPage(list2);
        }
    });	
}
</script> 

<!-- 增/減書籍 SRrangeBar -->
<link rel="stylesheet" type="text/css" href="Content/widgets/jquery-ui-1.12.1.custom/jquery-ui.min.css">
<script src="Content/widgets/jquery-ui-1.12.1.custom/jquery-ui.min.js"></script> 
<script src="Content/widgets/jquery-ui-1.12.1.custom/jquery.ui.touch-punch.min.js"></script> 
<script>
$(function() {
	$( '#SRrangeBar-s-range' ).slider({
		range: true,
      	min: 40,
      	max: 1000,
      	values: [ 310, 520 ],
		disabled: true,
    }).find('.ui-widget-header').append('<span class="slider-min"></span><span class="slider-max"></span>');;
	$('.ui-widget-header .slider-min').text('SR '+$( "#SRrangeBar-s-range" ).slider( "values", 0 ));
	$('.ui-widget-header .slider-max').text('SR '+$( "#SRrangeBar-s-range" ).slider( "values", 1 ));
    
    if( $('.ui-widget-header').width() <= 50 ){
        $('.ui-widget-header').addClass('smallWidth');   
    } 
	
	$( '#SRrangeBar-s-control' ).slider({
		range: true,
      	min: 40,
      	max: 1000,
      	values: [ 350, 650 ],
      	slide: function( event, ui ) {
			$('.ui-slider-handle:nth-of-type(1)').find('.slider-tooltip').text('SR '+ui.values[ 0 ]);
			$('.ui-slider-handle:nth-of-type(2)').find('.slider-tooltip').text('SR '+ui.values[ 1 ]);
		}
    }).find('.ui-slider-handle').append('<span class="slider-tooltip"></span>');
	$('.ui-slider-handle:nth-of-type(1)').find('.slider-tooltip').text('SR '+$( "#SRrangeBar-s-control" ).slider( "values", 0 ));
	$('.ui-slider-handle:nth-of-type(2)').find('.slider-tooltip').text('SR '+$( "#SRrangeBar-s-control" ).slider( "values", 1 ));
 });
</script> 

<!-- 增/減書籍(推薦書單) datatables  --> 
<script>
function loadRecommendedBook(json) { 
    const list3 = $('#recommendedBook');
	
	if ($.fn.DataTable.isDataTable(list3)) { 
        list3.DataTable().clear().destroy();
        list3.find('tbody').empty();
    }
	
	list3.DataTable({
        //serverSide: true,
        order: [],  //取消默認排序icon
        autoWidth: false,
        responsive: false,
		searching: true,
		pageLength: 8,
		pagingType: "simple_numbers",
		dom: '<"datatables-custom-header recommendedBook-table-header"Bip>'+
			 '<rt>'+
			 '<"datatables-custom-footer clearfix"pi>',
		buttons:[	
			{
			  text: '圖書難度&nbsp;<span class="glyphicon glyphicon-arrow-up" aria-hidden="true"></span>',
			  attr:  { id: 'sort_SR', class: 'dt-button dt-button-SRsort'},
			  action: function () {
				if( $('#sort_SR').hasClass('asc')){ //原本asc↑，變desc↓
					this.order( [ 4, 'desc' ] ).draw();
					$('#sort_SR').removeClass('active asc desc').addClass('active desc').siblings('.dt-button').removeClass('active asc desc');
					$('#sort_SR').find('.glyphicon').removeClass('glyphicon-arrow-up').addClass('glyphicon-arrow-down');
				}else{//原本null or desc↓變asc↑
					this.order( [ 4, 'asc' ] ).draw();
					$('#sort_SR').removeClass('active asc desc').addClass('active asc').siblings('.dt-button').removeClass('active asc desc');
					$('#sort_SR').find('.glyphicon').removeClass('glyphicon-arrow-down').addClass('glyphicon-arrow-up');
				}//if there has "SR 1000", that will need to debug......
			  }
			},
			{
			  text:`<img src="Content/images/recommendedBook/icon-goodBook.png" width="18" height="18">&nbsp;優選書優先&nbsp;
					<div class="form-check">
						<input type="checkbox" id="goodBook" class="form-check-input border-primary">
						<label for="goodBook" class="form-check-label"></label>
					</div>`,
			  attr:  { id: 'sort_good', class: 'dt-button dt-button-checkbox'},
			  action: function () {
				if( $('#sort_good').hasClass('desc')){ //原本asc↑，變desc↓
					this.order( [ 0, 'asc' ] ).draw();
					$('#sort_good').removeClass('active asc desc').siblings('.dt-button').removeClass('active asc desc');
					$('#sort_good').find('input[type="checkbox"]').removeAttr('checked');
				}else{//原本null 變desc↑
					this.order( [ 1, 'desc' ] ).draw();
					$('#sort_good').removeClass('active asc desc').addClass('active desc').siblings('.dt-button').removeClass('active asc desc');
					$('#sort_good').find('input[type="checkbox"]').attr('checked', 'checked');
				}
			  }//請改寫，暫以checked="checked"：#sort_good有內容desc排序優選書； checked=""：按原本#sort_id排序
			},
			{
			  text: `<img src="Content/images/recommendedBook/icon-ebook.png" width="18" height="18">&nbsp;電子書&nbsp;
					 <div class="form-check">
						<input type="checkbox" id="ebook" class="form-check-input border-primary">
						<label for="ebook" class="form-check-label"></label>
					 </div>`,
			  attr:  { id: 'sort_ebook', class: 'dt-button dt-button-checkbox'},
			  action: function () {
				  if( $('#sort_ebook').find('input[type="checkbox"]').prop('checked')){
					  $('#sort_ebook').find('input[type="checkbox"]').removeAttr('checked');
					  this.search('').draw(); 
				  }else{
					  $('#sort_ebook').find('input[type="checkbox"]').attr('checked', 'checked');
					  //do something...  
				  }
			  }
			},
			{
			  text: `<img src="Content/images/recommendedBook/borrowLink/bookplanet.png" height="24" alt="布可星球">
					 <div class="form-check">
						<input type="checkbox" id="bookplanet" class="form-check-input border-primary">
						<label for="bookplanet" class="form-check-label"></label>
					 </div>`,
			  attr:  { id: 'sort_bookplanet', class: 'dt-button dt-button-checkbox'},
			  action: function () {
				  let keywords = '<img src="Content/images/recommendedBook/borrowLink/bookplanet.png">';

				  if( $('#sort_bookplanet').find('input[type="checkbox"]').prop('checked')){
					  $('#sort_bookplanet').find('input[type="checkbox"]').removeAttr('checked');
					  this.search('').draw(); 
				  }else{
					  $('#sort_bookplanet').find('input[type="checkbox"]').attr('checked', 'checked');
					  //do something...
				  }
			  }
			},

		],
        language: {
          url: 'Content/widgets/DataTables/lang/Chinese-traditional.json',
		  info: `<span class="info-total"><span>共&nbsp;</span>_TOTAL_<span>&nbsp;本書</span></span>
				 <span class="info-page" ><span>第&nbsp;</span><strong class="text-red">_PAGE_</strong><span>&nbsp;頁</span>&nbsp;/</span>
				 <span class="info-pages"><span>共&nbsp;</span>_PAGES_<span>&nbsp;頁</span></span>`
        },
        ajax: 'Content/json/RP-bookList/recommendedBook.json',
        columnDefs: [
            {//ID
                targets: 0, 
                title: 'ID',
                className: 'row-id',
                orderable: false,
				visible: false,
                render: function (data, type, row, meta) {
                    return meta.row + 1; 
                } 
            },
            {//優選書單
                targets: 1, 
                title: '優選書單',
                data: 'good',
                className: 'row-good',
                orderable: false, 
                render: function (data, type, row, meta) {
                    let good;
                    switch (data) {
                        case 1:
                            good = `<img src="Content/images/recommendedBook/goodBook.png" width="66" height="65">`;
                            break
                        case 0:
                            good = ``;
                            break    
                        default:
                            good = ``;
                            break 
                    }
                    return good;
                } 
            },
            {//書封面
                targets: 2,
                title: '書封面',
                data: 'cover',
                className: 'row-cover',
                orderable: false,
				render: function (data, type, row, meta) {
                    return `<img src="https://smartreading.net/RP/BookContent/BookFront/`+ data +`">`;
                } 
            },
            {//書名
                targets: 3, 
                title: '書名',
                data: 'bookTitle',
                className: 'row-bookTitle',
                orderable: false,
            },
            {//圖書難度
                targets: 4, 
                title: '圖書難度',
                data: 'SR',
                className: 'row-SR',
                orderable: false,
                render: function (data, type, row, meta) {
                    return `SR `+ data;
                },
				createdCell: function (td, cellData, rowData, row, col) {
					$(td).attr('data-th', '圖書難度');
				}
            },
            {//分類
                targets: 5, 
                title: '分類',
                data: 'category',
                className: 'row-category',
                orderable: false,
				createdCell: function (td, cellData, rowData, row, col) {
					$(td).attr('data-th', '分類');
				}
            },
            {//題本類別
                targets: 6, 
                title: '題本類別',
                data: 'topicType',
                className: 'row-topicType',
                orderable: false,
				createdCell: function (td, cellData, rowData, row, col) {
					$(td).attr('data-th', '題本類別');
				}
            },
			{//電子書
                targets: 7, 
                title: '電子書',
                data: 'ebook',
                width: '10%',
                className: 'row-ebook',
                orderable: false,
                render: function (data, type, row, meta) {
                    let ebook;
                    switch (data) {
                        case 1:
                            ebook = `<img src="Content/images/recommendedBook/icon-ebook.png" width="18" height="18">&nbsp;電子書`;
                            break
                        case 0:
                            ebook = `<img src="Content/images/recommendedBook/icon-ebook-gray.png" width="18" height="18">&nbsp;電子書`;
                            break    
                        default:
                            ebook = `<img src="Content/images/recommendedBook/icon-ebook-gray.png" width="18" height="18">&nbsp;電子書`;
                            break 
                    }
                    return ebook;
                } 
            },
			{//加入書單
                targets: 8, 
                title: '加入書單',
                className: 'row-checkbox',
                orderable: false,
                render: function (data, type, row, meta) {
                    return `<div class="form-check form-check-inline">
                          <input class="form-check-input border-primary" type="checkbox" value="" id="checkbox8">
                          <label class="form-check-label visually-hidden" for="checkbox` + data + `">加入書單</label>
                        </div>`;
                }
            },
			{//布可星球
                targets: 9, 
                title: '布可星球',
                data: 'bookplanet',
                width: '10%',
                className: 'row-bookplanet',
                orderable: false,
                render: function (data, type, row, meta) {
                    let bookplanet;
                    switch (data) {
                        case 1:
                            bookplanet = `<img src="Content/images/recommendedBook/borrowLink/bookplanet.png">`;
                            break
                        case 0:
                            bookplanet = ``;
                            break    
                        default:
                            bookplanet = ``;
                            break 
                    }
                    return bookplanet;
                } 
            },   
        ],
        initComplete: function() {
            //datatable footer input page
            datatableInputPage(list3);
        }
    });
}
</script>
</body>
</html>
